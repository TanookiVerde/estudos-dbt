[0m09:17:25.378850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2835f5ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2834253190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f283422c400>]}


============================== 09:17:25.382709 | 48440ff8-668a-4dd4-963d-72364f59387d ==============================
[0m09:17:25.382709 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:17:25.383497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:17:27.199920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48440ff8-668a-4dd4-963d-72364f59387d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28342415e0>]}
[0m09:17:27.381895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48440ff8-668a-4dd4-963d-72364f59387d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2822dd5dc0>]}
[0m09:17:27.386029 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m09:17:27.404639 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:17:27.407417 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:17:27.409112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '48440ff8-668a-4dd4-963d-72364f59387d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282307d160>]}
[0m09:17:28.780401 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.football.marts
- models.football.staging
[0m09:17:28.787200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48440ff8-668a-4dd4-963d-72364f59387d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2822cd4e20>]}
[0m09:17:28.810484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48440ff8-668a-4dd4-963d-72364f59387d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2822cf96a0>]}
[0m09:17:28.811166 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:17:28.811739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48440ff8-668a-4dd4-963d-72364f59387d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282311fc10>]}
[0m09:17:28.813275 [info ] [MainThread]: 
[0m09:17:28.814528 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:17:28.816359 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery'
[0m09:17:28.817438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:17:34.915049 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
  '
[0m09:17:34.919701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:17:34.921214 [debug] [MainThread]: Connection 'list_estudos-dbt-e-bigquery' was properly closed.
[0m09:17:34.922633 [info ] [MainThread]: 
[0m09:17:34.924199 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 6.11 seconds (6.11s).
[0m09:17:34.926087 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
    
[0m09:17:34.928014 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.641976, "process_user_time": 5.292749, "process_kernel_time": 0.457284, "process_mem_max_rss": "181700", "process_in_blocks": "182232", "process_out_blocks": "1808", "command_success": false}
[0m09:17:34.930096 [debug] [MainThread]: Command `dbt run` failed at 09:17:34.929561 after 9.64 seconds
[0m09:17:34.932428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2835f5ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282312ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2822ca5730>]}
[0m09:17:34.934741 [debug] [MainThread]: Flushing usage events
[0m09:18:14.153273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411915ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4117452190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4117440400>]}


============================== 09:18:14.156421 | cecba9d8-f696-452e-82b7-edd05cc4e66e ==============================
[0m09:18:14.156421 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:18:14.157204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:18:15.333181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cecba9d8-f696-452e-82b7-edd05cc4e66e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4106735d90>]}
[0m09:18:15.528335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cecba9d8-f696-452e-82b7-edd05cc4e66e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4105fc9dc0>]}
[0m09:18:15.529287 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m09:18:15.541260 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:18:15.560092 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:18:15.560798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cecba9d8-f696-452e-82b7-edd05cc4e66e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f410639cc10>]}
[0m09:18:16.921894 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.football.staging
- models.football.marts
[0m09:18:16.927931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cecba9d8-f696-452e-82b7-edd05cc4e66e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4105f3b760>]}
[0m09:18:16.950748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cecba9d8-f696-452e-82b7-edd05cc4e66e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4105f3ba00>]}
[0m09:18:16.952320 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:18:16.953365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cecba9d8-f696-452e-82b7-edd05cc4e66e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4105f05370>]}
[0m09:18:16.955298 [info ] [MainThread]: 
[0m09:18:16.956384 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:18:16.958164 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery'
[0m09:18:16.959195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:18:17.845041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery, now create_estudos-dbt-e-bigquery_dbt_football)
[0m09:18:17.847737 [debug] [ThreadPool]: Creating schema "database: "estudos-dbt-e-bigquery"
schema: "dbt_football"
"
[0m09:18:17.859138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:18:17.900704 [debug] [ThreadPool]: On create_estudos-dbt-e-bigquery_dbt_football: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "connection_name": "create_estudos-dbt-e-bigquery_dbt_football"} */
create schema if not exists `estudos-dbt-e-bigquery`.`dbt_football`
  
[0m09:18:18.866910 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:5521f92e-d5f3-4d37-86a0-bad5cd50e1fc&page=queryresults
[0m09:18:19.692572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_estudos-dbt-e-bigquery_dbt_football, now list_estudos-dbt-e-bigquery_dbt_football)
[0m09:18:19.694397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:18:20.609277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cecba9d8-f696-452e-82b7-edd05cc4e66e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4105767640>]}
[0m09:18:20.611872 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:18:20.613695 [info ] [MainThread]: 
[0m09:18:20.627517 [debug] [Thread-2  ]: Began running node model.estudos_dbt.stg_football_rankings
[0m09:18:20.634281 [info ] [Thread-2  ]: 2 of 3 START sql view model dbt_football.stg_football_rankings ................. [RUN]
[0m09:18:20.637504 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.estudos_dbt.stg_football_rankings'
[0m09:18:20.641256 [debug] [Thread-2  ]: Began compiling node model.estudos_dbt.stg_football_rankings
[0m09:18:20.659682 [debug] [Thread-1  ]: Began running node model.estudos_dbt.stg_football_matches
[0m09:18:20.661097 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt_football.stg_football_matches .................. [RUN]
[0m09:18:20.664333 [debug] [Thread-2  ]: Writing injected SQL for node "model.estudos_dbt.stg_football_rankings"
[0m09:18:20.667097 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now model.estudos_dbt.stg_football_matches)
[0m09:18:20.669989 [debug] [Thread-1  ]: Began compiling node model.estudos_dbt.stg_football_matches
[0m09:18:20.673299 [debug] [Thread-1  ]: Writing injected SQL for node "model.estudos_dbt.stg_football_matches"
[0m09:18:20.674383 [debug] [Thread-2  ]: Timing info for model.estudos_dbt.stg_football_rankings (compile): 09:18:20.642542 => 09:18:20.673940
[0m09:18:20.675047 [debug] [Thread-1  ]: Timing info for model.estudos_dbt.stg_football_matches (compile): 09:18:20.670892 => 09:18:20.674732
[0m09:18:20.675629 [debug] [Thread-2  ]: Began executing node model.estudos_dbt.stg_football_rankings
[0m09:18:20.676243 [debug] [Thread-1  ]: Began executing node model.estudos_dbt.stg_football_matches
[0m09:18:20.742355 [debug] [Thread-2  ]: Writing runtime sql for node "model.estudos_dbt.stg_football_rankings"
[0m09:18:20.743967 [debug] [Thread-1  ]: Writing runtime sql for node "model.estudos_dbt.stg_football_matches"
[0m09:18:20.745358 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:18:20.746303 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:18:20.813365 [debug] [Thread-1  ]: On model.estudos_dbt.stg_football_matches: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.stg_football_matches"} */


  create or replace view `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
  OPTIONS()
  as SELECT * 
FROM estudos-dbt-e-bigquery.football.spi_matches_latest;


[0m09:18:20.815360 [debug] [Thread-2  ]: On model.estudos_dbt.stg_football_rankings: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.stg_football_rankings"} */


  create or replace view `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_rankings`
  OPTIONS()
  as SELECT * 
FROM estudos-dbt-e-bigquery.football.spi_global_rankings;


[0m09:18:21.835861 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:fd176e42-0617-41ef-841c-1a59012bd29c&page=queryresults
[0m09:18:21.838409 [debug] [Thread-2  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.stg_football_rankings"} */


  create or replace view `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_rankings`
  OPTIONS()
  as SELECT * 
FROM estudos-dbt-e-bigquery.football.spi_global_rankings;


[0m09:18:21.839575 [debug] [Thread-2  ]: BigQuery adapter: 404 Not found: Table estudos-dbt-e-bigquery:football.spi_global_rankings was not found in location US

Location: US
Job ID: fd176e42-0617-41ef-841c-1a59012bd29c

[0m09:18:21.840361 [debug] [Thread-2  ]: Timing info for model.estudos_dbt.stg_football_rankings (execute): 09:18:20.676616 => 09:18:21.840047
[0m09:18:21.853324 [debug] [Thread-2  ]: Runtime Error in model stg_football_rankings (models/football/staging/stg_football_rankings.sql)
  404 Not found: Table estudos-dbt-e-bigquery:football.spi_global_rankings was not found in location US
  
  Location: US
  Job ID: fd176e42-0617-41ef-841c-1a59012bd29c
  
[0m09:18:21.854172 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cecba9d8-f696-452e-82b7-edd05cc4e66e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41053fc880>]}
[0m09:18:21.855008 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model dbt_football.stg_football_rankings ........ [[31mERROR[0m in 1.22s]
[0m09:18:21.855971 [debug] [Thread-2  ]: Finished running node model.estudos_dbt.stg_football_rankings
[0m09:18:22.246534 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:ce8a31ef-704f-4692-9c0b-7f215640d31b&page=queryresults
[0m09:18:23.002048 [debug] [Thread-1  ]: Timing info for model.estudos_dbt.stg_football_matches (execute): 09:18:20.682387 => 09:18:23.001573
[0m09:18:23.003589 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cecba9d8-f696-452e-82b7-edd05cc4e66e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4105355cd0>]}
[0m09:18:23.004656 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt_football.stg_football_matches ............. [[32mCREATE VIEW (0 processed)[0m in 2.34s]
[0m09:18:23.005810 [debug] [Thread-1  ]: Finished running node model.estudos_dbt.stg_football_matches
[0m09:18:23.007265 [debug] [Thread-4  ]: Began running node model.estudos_dbt.mart_football_information
[0m09:18:23.008064 [info ] [Thread-4  ]: 3 of 3 SKIP relation dbt_football.mart_football_information .................... [[33mSKIP[0m]
[0m09:18:23.008807 [debug] [Thread-4  ]: Finished running node model.estudos_dbt.mart_football_information
[0m09:18:23.011055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:18:23.011912 [debug] [MainThread]: Connection 'model.estudos_dbt.stg_football_matches' was properly closed.
[0m09:18:23.012762 [debug] [MainThread]: Connection 'model.estudos_dbt.stg_football_rankings' was properly closed.
[0m09:18:23.013831 [info ] [MainThread]: 
[0m09:18:23.014773 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 6.06 seconds (6.06s).
[0m09:18:23.016129 [debug] [MainThread]: Command end result
[0m09:18:23.039633 [info ] [MainThread]: 
[0m09:18:23.040296 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:18:23.040949 [info ] [MainThread]: 
[0m09:18:23.041859 [error] [MainThread]:   Runtime Error in model stg_football_rankings (models/football/staging/stg_football_rankings.sql)
  404 Not found: Table estudos-dbt-e-bigquery:football.spi_global_rankings was not found in location US
  
  Location: US
  Job ID: fd176e42-0617-41ef-841c-1a59012bd29c
  
[0m09:18:23.042749 [info ] [MainThread]: 
[0m09:18:23.043314 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m09:18:23.044001 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.974396, "process_user_time": 6.992136, "process_kernel_time": 0.391336, "process_mem_max_rss": "196828", "process_in_blocks": "2464", "process_out_blocks": "2728", "command_success": false}
[0m09:18:23.044746 [debug] [MainThread]: Command `dbt run` failed at 09:18:23.044558 after 8.98 seconds
[0m09:18:23.046340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411915ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4105f05370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f410627e160>]}
[0m09:18:23.049231 [debug] [MainThread]: Flushing usage events
[0m09:20:29.255347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaab25c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaa954faf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaa9547f70>]}


============================== 09:20:29.258417 | 7311ff80-b21e-4b6e-adbd-d947aa300c91 ==============================
[0m09:20:29.258417 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:20:29.259423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:20:30.468425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7311ff80-b21e-4b6e-adbd-d947aa300c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9853ef40>]}
[0m09:20:30.673590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7311ff80-b21e-4b6e-adbd-d947aa300c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa98479580>]}
[0m09:20:30.674524 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m09:20:30.687721 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:20:30.739329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:20:30.740783 [debug] [MainThread]: Partial parsing: updated file: estudos_dbt://models/football/staging/stg_football_rankings.sql
[0m09:20:31.112124 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.football.marts
- models.football.staging
[0m09:20:31.119407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7311ff80-b21e-4b6e-adbd-d947aa300c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa975e7190>]}
[0m09:20:31.144052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7311ff80-b21e-4b6e-adbd-d947aa300c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa97ca0d30>]}
[0m09:20:31.144694 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:20:31.145230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7311ff80-b21e-4b6e-adbd-d947aa300c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa97d5d940>]}
[0m09:20:31.146909 [info ] [MainThread]: 
[0m09:20:31.147926 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:20:31.152298 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery'
[0m09:20:31.154452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:31.992138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery, now list_estudos-dbt-e-bigquery_dbt_football)
[0m09:20:31.993849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:20:32.734486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7311ff80-b21e-4b6e-adbd-d947aa300c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa980f78b0>]}
[0m09:20:32.737581 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:20:32.739715 [info ] [MainThread]: 
[0m09:20:32.749461 [debug] [Thread-1  ]: Began running node model.estudos_dbt.stg_football_matches
[0m09:20:32.753278 [debug] [Thread-2  ]: Began running node model.estudos_dbt.stg_football_rankings
[0m09:20:32.757069 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt_football.stg_football_matches .................. [RUN]
[0m09:20:32.760459 [info ] [Thread-2  ]: 2 of 3 START sql view model dbt_football.stg_football_rankings ................. [RUN]
[0m09:20:32.768024 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.estudos_dbt.stg_football_rankings'
[0m09:20:32.764119 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now model.estudos_dbt.stg_football_matches)
[0m09:20:32.770228 [debug] [Thread-2  ]: Began compiling node model.estudos_dbt.stg_football_rankings
[0m09:20:32.771982 [debug] [Thread-1  ]: Began compiling node model.estudos_dbt.stg_football_matches
[0m09:20:32.780843 [debug] [Thread-1  ]: Writing injected SQL for node "model.estudos_dbt.stg_football_matches"
[0m09:20:32.788143 [debug] [Thread-1  ]: Timing info for model.estudos_dbt.stg_football_matches (compile): 09:20:32.778287 => 09:20:32.787032
[0m09:20:32.794591 [debug] [Thread-1  ]: Began executing node model.estudos_dbt.stg_football_matches
[0m09:20:32.796522 [debug] [Thread-2  ]: Writing injected SQL for node "model.estudos_dbt.stg_football_rankings"
[0m09:20:32.807012 [debug] [Thread-2  ]: Timing info for model.estudos_dbt.stg_football_rankings (compile): 09:20:32.773160 => 09:20:32.806332
[0m09:20:32.807753 [debug] [Thread-2  ]: Began executing node model.estudos_dbt.stg_football_rankings
[0m09:20:32.960094 [debug] [Thread-2  ]: Writing runtime sql for node "model.estudos_dbt.stg_football_rankings"
[0m09:20:32.960933 [debug] [Thread-1  ]: Writing runtime sql for node "model.estudos_dbt.stg_football_matches"
[0m09:20:32.961901 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:20:32.962520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:20:33.042873 [debug] [Thread-2  ]: On model.estudos_dbt.stg_football_rankings: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.stg_football_rankings"} */


  create or replace view `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_rankings`
  OPTIONS()
  as SELECT * 
FROM estudos-dbt-e-bigquery.football.spi_global_ranking;


[0m09:20:33.044690 [debug] [Thread-1  ]: On model.estudos_dbt.stg_football_matches: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.stg_football_matches"} */


  create or replace view `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
  OPTIONS()
  as SELECT * 
FROM estudos-dbt-e-bigquery.football.spi_matches_latest;


[0m09:20:34.239709 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:f7fff82e-618e-4fa3-afe1-5dfa97593604&page=queryresults
[0m09:20:34.240823 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:4ce3a7b0-c313-4e38-a345-61734e0d521b&page=queryresults
[0m09:20:34.896329 [debug] [Thread-2  ]: Timing info for model.estudos_dbt.stg_football_rankings (execute): 09:20:32.808244 => 09:20:34.896016
[0m09:20:34.898677 [debug] [Thread-1  ]: Timing info for model.estudos_dbt.stg_football_matches (execute): 09:20:32.796918 => 09:20:34.898334
[0m09:20:34.899803 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7311ff80-b21e-4b6e-adbd-d947aa300c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa97457cd0>]}
[0m09:20:34.900826 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7311ff80-b21e-4b6e-adbd-d947aa300c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa978a9df0>]}
[0m09:20:34.902042 [info ] [Thread-2  ]: 2 of 3 OK created sql view model dbt_football.stg_football_rankings ............ [[32mCREATE VIEW (0 processed)[0m in 2.13s]
[0m09:20:34.903107 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt_football.stg_football_matches ............. [[32mCREATE VIEW (0 processed)[0m in 2.14s]
[0m09:20:34.904061 [debug] [Thread-2  ]: Finished running node model.estudos_dbt.stg_football_rankings
[0m09:20:34.904840 [debug] [Thread-1  ]: Finished running node model.estudos_dbt.stg_football_matches
[0m09:20:34.906131 [debug] [Thread-4  ]: Began running node model.estudos_dbt.mart_football_information
[0m09:20:34.906819 [info ] [Thread-4  ]: 3 of 3 START sql view model dbt_football.mart_football_information ............. [RUN]
[0m09:20:34.908267 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.estudos_dbt.mart_football_information'
[0m09:20:34.909064 [debug] [Thread-4  ]: Began compiling node model.estudos_dbt.mart_football_information
[0m09:20:34.913736 [debug] [Thread-4  ]: Writing injected SQL for node "model.estudos_dbt.mart_football_information"
[0m09:20:34.914741 [debug] [Thread-4  ]: Timing info for model.estudos_dbt.mart_football_information (compile): 09:20:34.909478 => 09:20:34.914399
[0m09:20:34.915658 [debug] [Thread-4  ]: Began executing node model.estudos_dbt.mart_football_information
[0m09:20:34.920050 [debug] [Thread-4  ]: Writing runtime sql for node "model.estudos_dbt.mart_football_information"
[0m09:20:34.920919 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:20:34.973550 [debug] [Thread-4  ]: On model.estudos_dbt.mart_football_information: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.mart_football_information"} */


  create or replace view `estudos-dbt-e-bigquery`.`dbt_football`.`mart_football_information`
  OPTIONS()
  as with
  qryMatches as (
    SELECT * FROM `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches` where league = 'Barclays Premier League'
    ),
  qryRankings as (
    SELECT * FROM `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_rankings` where league = 'Barclays Premier League'
  ),

  qryFinal as (
    select
      qryMatches.season,
      qryMatches.date,
      qryMatches.league,
      qryMatches.team1,
      qryMatches.team2,
      team_one.rank as team1_rank,
      team_two.rank as team2_rank
    from
      qryMatches join
      qryRankings as team_one on
        (qryMatches.team1 = team_one.name) join
      qryRankings as team_two on
        (qryMatches.team2 = team_two.name)
  )

select * from qryFinal;


[0m09:20:36.087109 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:db06a9d9-c17b-4f97-a762-b9bcfd40df9c&page=queryresults
[0m09:20:36.705732 [debug] [Thread-4  ]: Timing info for model.estudos_dbt.mart_football_information (execute): 09:20:34.916109 => 09:20:36.704860
[0m09:20:36.708438 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7311ff80-b21e-4b6e-adbd-d947aa300c91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa974f7a90>]}
[0m09:20:36.710588 [info ] [Thread-4  ]: 3 of 3 OK created sql view model dbt_football.mart_football_information ........ [[32mCREATE VIEW (0 processed)[0m in 1.80s]
[0m09:20:36.712982 [debug] [Thread-4  ]: Finished running node model.estudos_dbt.mart_football_information
[0m09:20:36.720382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:20:36.723398 [debug] [MainThread]: Connection 'model.estudos_dbt.stg_football_matches' was properly closed.
[0m09:20:36.726097 [debug] [MainThread]: Connection 'model.estudos_dbt.stg_football_rankings' was properly closed.
[0m09:20:36.727962 [debug] [MainThread]: Connection 'model.estudos_dbt.mart_football_information' was properly closed.
[0m09:20:36.730865 [info ] [MainThread]: 
[0m09:20:36.733387 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.58 seconds (5.58s).
[0m09:20:36.737994 [debug] [MainThread]: Command end result
[0m09:20:36.763402 [info ] [MainThread]: 
[0m09:20:36.764095 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:20:36.766195 [info ] [MainThread]: 
[0m09:20:36.768457 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:20:36.771109 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.608615, "process_user_time": 6.282182, "process_kernel_time": 0.475559, "process_mem_max_rss": "195516", "process_out_blocks": "2752", "process_in_blocks": "0"}
[0m09:20:36.773961 [debug] [MainThread]: Command `dbt run` succeeded at 09:20:36.773363 after 7.61 seconds
[0m09:20:36.775546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaab25c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa984997c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa980fe190>]}
[0m09:20:36.776930 [debug] [MainThread]: Flushing usage events
[0m09:22:40.744397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc7e58a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc6155190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc6142400>]}


============================== 09:22:40.747448 | 0fabd0ed-88ee-4af5-aa33-b4ca37027fd9 ==============================
[0m09:22:40.747448 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:22:40.748259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:22:41.951992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fabd0ed-88ee-4af5-aa33-b4ca37027fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb51b5d90>]}
[0m09:22:42.142269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fabd0ed-88ee-4af5-aa33-b4ca37027fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb5139ac0>]}
[0m09:22:42.143174 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m09:22:42.154644 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:22:42.171302 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:22:42.172930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0fabd0ed-88ee-4af5-aa33-b4ca37027fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb4dc8580>]}
[0m09:22:43.729660 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.football.staging
- models.football.marts
[0m09:22:43.737939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fabd0ed-88ee-4af5-aa33-b4ca37027fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb44bb760>]}
[0m09:22:43.763238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fabd0ed-88ee-4af5-aa33-b4ca37027fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb44bba00>]}
[0m09:22:43.763900 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:22:43.764452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fabd0ed-88ee-4af5-aa33-b4ca37027fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb4d52e20>]}
[0m09:22:43.765999 [info ] [MainThread]: 
[0m09:22:43.769462 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:22:43.773785 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery'
[0m09:22:43.775684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:22:44.597700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery, now list_estudos-dbt-e-bigquery_dbt_football)
[0m09:22:44.598731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:22:45.417228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fabd0ed-88ee-4af5-aa33-b4ca37027fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb4109d90>]}
[0m09:22:45.418925 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:22:45.419969 [info ] [MainThread]: 
[0m09:22:45.423486 [debug] [Thread-1  ]: Began running node model.estudos_dbt.stg_football_matches
[0m09:22:45.424310 [debug] [Thread-2  ]: Began running node model.estudos_dbt.stg_football_rankings
[0m09:22:45.425786 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt_football.stg_football_matches .................. [RUN]
[0m09:22:45.427322 [info ] [Thread-2  ]: 2 of 3 START sql view model dbt_football.stg_football_rankings ................. [RUN]
[0m09:22:45.429529 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now model.estudos_dbt.stg_football_matches)
[0m09:22:45.431337 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.estudos_dbt.stg_football_rankings'
[0m09:22:45.432700 [debug] [Thread-1  ]: Began compiling node model.estudos_dbt.stg_football_matches
[0m09:22:45.434162 [debug] [Thread-2  ]: Began compiling node model.estudos_dbt.stg_football_rankings
[0m09:22:45.447866 [debug] [Thread-1  ]: Writing injected SQL for node "model.estudos_dbt.stg_football_matches"
[0m09:22:45.453801 [debug] [Thread-1  ]: Timing info for model.estudos_dbt.stg_football_matches (compile): 09:22:45.435086 => 09:22:45.453032
[0m09:22:45.455944 [debug] [Thread-1  ]: Began executing node model.estudos_dbt.stg_football_matches
[0m09:22:45.482005 [debug] [Thread-2  ]: Writing injected SQL for node "model.estudos_dbt.stg_football_rankings"
[0m09:22:45.504290 [debug] [Thread-2  ]: Timing info for model.estudos_dbt.stg_football_rankings (compile): 09:22:45.446676 => 09:22:45.503756
[0m09:22:45.510114 [debug] [Thread-2  ]: Began executing node model.estudos_dbt.stg_football_rankings
[0m09:22:45.521720 [debug] [Thread-1  ]: Writing runtime sql for node "model.estudos_dbt.stg_football_matches"
[0m09:22:45.524234 [debug] [Thread-2  ]: Writing runtime sql for node "model.estudos_dbt.stg_football_rankings"
[0m09:22:45.525437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:22:45.526324 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:22:45.607271 [debug] [Thread-2  ]: On model.estudos_dbt.stg_football_rankings: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.stg_football_rankings"} */


  create or replace view `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_rankings`
  OPTIONS()
  as SELECT * 
FROM estudos-dbt-e-bigquery.football.spi_global_ranking;


[0m09:22:45.608485 [debug] [Thread-1  ]: On model.estudos_dbt.stg_football_matches: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.stg_football_matches"} */


  create or replace view `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
  OPTIONS()
  as SELECT * 
FROM estudos-dbt-e-bigquery.football.spi_matches_latest;


[0m09:22:46.749198 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:03f03f7e-7e64-4612-a454-359f8bf23b01&page=queryresults
[0m09:22:46.751797 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:37013fe2-05ca-4e13-8ada-d6d8bc1c570e&page=queryresults
[0m09:22:47.320950 [debug] [Thread-2  ]: Timing info for model.estudos_dbt.stg_football_rankings (execute): 09:22:45.516181 => 09:22:47.320464
[0m09:22:47.322234 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fabd0ed-88ee-4af5-aa33-b4ca37027fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb408f790>]}
[0m09:22:47.323092 [info ] [Thread-2  ]: 2 of 3 OK created sql view model dbt_football.stg_football_rankings ............ [[32mCREATE VIEW (0 processed)[0m in 1.89s]
[0m09:22:47.323663 [debug] [Thread-1  ]: Timing info for model.estudos_dbt.stg_football_matches (execute): 09:22:45.457633 => 09:22:47.318511
[0m09:22:47.324510 [debug] [Thread-2  ]: Finished running node model.estudos_dbt.stg_football_rankings
[0m09:22:47.325498 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fabd0ed-88ee-4af5-aa33-b4ca37027fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb40d2f40>]}
[0m09:22:47.326855 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt_football.stg_football_matches ............. [[32mCREATE VIEW (0 processed)[0m in 1.90s]
[0m09:22:47.327785 [debug] [Thread-1  ]: Finished running node model.estudos_dbt.stg_football_matches
[0m09:22:47.329106 [debug] [Thread-4  ]: Began running node model.estudos_dbt.mart_football_information
[0m09:22:47.330181 [info ] [Thread-4  ]: 3 of 3 START sql view model dbt_football.mart_football_information ............. [RUN]
[0m09:22:47.331454 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.estudos_dbt.mart_football_information'
[0m09:22:47.332345 [debug] [Thread-4  ]: Began compiling node model.estudos_dbt.mart_football_information
[0m09:22:47.341322 [debug] [Thread-4  ]: Writing injected SQL for node "model.estudos_dbt.mart_football_information"
[0m09:22:47.343093 [debug] [Thread-4  ]: Timing info for model.estudos_dbt.mart_football_information (compile): 09:22:47.332975 => 09:22:47.342474
[0m09:22:47.344154 [debug] [Thread-4  ]: Began executing node model.estudos_dbt.mart_football_information
[0m09:22:47.354450 [debug] [Thread-4  ]: Writing runtime sql for node "model.estudos_dbt.mart_football_information"
[0m09:22:47.356077 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:22:47.405531 [debug] [Thread-4  ]: On model.estudos_dbt.mart_football_information: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.mart_football_information"} */


  create or replace view `estudos-dbt-e-bigquery`.`dbt_football`.`mart_football_information`
  OPTIONS()
  as with
  qryMatches as (
    SELECT * FROM `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches` where league = 'Barclays Premier League'
    ),
  qryRankings as (
    SELECT * FROM `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_rankings` where league = 'Barclays Premier League'
  ),

  qryFinal as (
    select
      qryMatches.season,
      qryMatches.date,
      qryMatches.league,
      qryMatches.team1,
      qryMatches.team2,
      team_one.rank as team1_rank,
      team_two.rank as team2_rank
    from
      qryMatches join
      qryRankings as team_one on
        (qryMatches.team1 = team_one.name) join
      qryRankings as team_two on
        (qryMatches.team2 = team_two.name)
  )

select * from qryFinal;


[0m09:22:48.488349 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:16419793-3972-431f-bed3-d02ed85664b2&page=queryresults
[0m09:22:49.007812 [debug] [Thread-4  ]: Timing info for model.estudos_dbt.mart_football_information (execute): 09:22:47.344792 => 09:22:49.006848
[0m09:22:49.010448 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fabd0ed-88ee-4af5-aa33-b4ca37027fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb40d2610>]}
[0m09:22:49.011766 [info ] [Thread-4  ]: 3 of 3 OK created sql view model dbt_football.mart_football_information ........ [[32mCREATE VIEW (0 processed)[0m in 1.68s]
[0m09:22:49.013162 [debug] [Thread-4  ]: Finished running node model.estudos_dbt.mart_football_information
[0m09:22:49.017285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:22:49.018794 [debug] [MainThread]: Connection 'model.estudos_dbt.stg_football_matches' was properly closed.
[0m09:22:49.020401 [debug] [MainThread]: Connection 'model.estudos_dbt.stg_football_rankings' was properly closed.
[0m09:22:49.021713 [debug] [MainThread]: Connection 'model.estudos_dbt.mart_football_information' was properly closed.
[0m09:22:49.022782 [info ] [MainThread]: 
[0m09:22:49.024073 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.26 seconds (5.26s).
[0m09:22:49.026747 [debug] [MainThread]: Command end result
[0m09:22:49.062594 [info ] [MainThread]: 
[0m09:22:49.063288 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:22:49.063935 [info ] [MainThread]: 
[0m09:22:49.064593 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:22:49.065285 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.412029, "process_user_time": 7.60305, "process_kernel_time": 0.415811, "process_mem_max_rss": "195740", "process_out_blocks": "2744", "process_in_blocks": "0"}
[0m09:22:49.066656 [debug] [MainThread]: Command `dbt run` succeeded at 09:22:49.065917 after 8.41 seconds
[0m09:22:49.069276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc7e58a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb4cfe670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb4cee760>]}
[0m09:22:49.071302 [debug] [MainThread]: Flushing usage events
[0m09:23:32.523575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d9b339af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d99607670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d99607e20>]}


============================== 09:23:32.526795 | e10bcc75-cc50-4e18-bfde-63f5add393a2 ==============================
[0m09:23:32.526795 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:23:32.527635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m09:23:33.718538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e10bcc75-cc50-4e18-bfde-63f5add393a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d99641400>]}
[0m09:23:33.936943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e10bcc75-cc50-4e18-bfde-63f5add393a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d881fad90>]}
[0m09:23:33.937838 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m09:23:33.951900 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:23:33.973051 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:23:33.973820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e10bcc75-cc50-4e18-bfde-63f5add393a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d884acf10>]}
[0m09:23:35.491434 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.football.marts
- models.football.staging
[0m09:23:35.501205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e10bcc75-cc50-4e18-bfde-63f5add393a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d879be7f0>]}
[0m09:23:35.522418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e10bcc75-cc50-4e18-bfde-63f5add393a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d87924070>]}
[0m09:23:35.523083 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:23:35.523635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e10bcc75-cc50-4e18-bfde-63f5add393a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d8856f850>]}
[0m09:23:35.525025 [info ] [MainThread]: 
[0m09:23:35.525591 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:23:35.526362 [debug] [MainThread]: Command end result
[0m09:23:35.549092 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.1115248, "process_user_time": 5.554571, "process_kernel_time": 0.342625, "process_mem_max_rss": "183276", "process_out_blocks": "2688", "process_in_blocks": "0"}
[0m09:23:35.551538 [debug] [MainThread]: Command `dbt test` succeeded at 09:23:35.551112 after 3.11 seconds
[0m09:23:35.552895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d9b339af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d884dc5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d881fad90>]}
[0m09:23:35.554229 [debug] [MainThread]: Flushing usage events
[0m09:23:58.896305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793221c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79305106d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7930510e80>]}


============================== 09:23:58.899342 | cd411f7e-cfbd-4e8f-895b-3c1b81678d1b ==============================
[0m09:23:58.899342 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:23:58.900092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:24:00.100349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd411f7e-cfbd-4e8f-895b-3c1b81678d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7930575dc0>]}
[0m09:24:00.339910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd411f7e-cfbd-4e8f-895b-3c1b81678d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f791f539d00>]}
[0m09:24:00.341309 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m09:24:00.360834 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:24:00.406977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:24:00.407735 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:24:00.408808 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.football.marts
- models.football.staging
[0m09:24:00.417734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd411f7e-cfbd-4e8f-895b-3c1b81678d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f791ec43af0>]}
[0m09:24:00.436362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd411f7e-cfbd-4e8f-895b-3c1b81678d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f791f148070>]}
[0m09:24:00.437237 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:24:00.439160 [info ] [MainThread]: 
[0m09:24:00.440685 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:24:00.445947 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery'
[0m09:24:00.448161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:01.399413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery, now list_estudos-dbt-e-bigquery_dbt_football)
[0m09:24:01.400753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:02.217243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd411f7e-cfbd-4e8f-895b-3c1b81678d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f791f16a070>]}
[0m09:24:02.218920 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:24:02.219967 [info ] [MainThread]: 
[0m09:24:02.222930 [debug] [Thread-1  ]: Began running node model.estudos_dbt.stg_football_matches
[0m09:24:02.224420 [debug] [Thread-2  ]: Began running node model.estudos_dbt.stg_football_rankings
[0m09:24:02.226087 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt_football.stg_football_matches .................. [RUN]
[0m09:24:02.227912 [info ] [Thread-2  ]: 2 of 3 START sql view model dbt_football.stg_football_rankings ................. [RUN]
[0m09:24:02.229980 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now model.estudos_dbt.stg_football_matches)
[0m09:24:02.231151 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.estudos_dbt.stg_football_rankings'
[0m09:24:02.232549 [debug] [Thread-1  ]: Began compiling node model.estudos_dbt.stg_football_matches
[0m09:24:02.234349 [debug] [Thread-2  ]: Began compiling node model.estudos_dbt.stg_football_rankings
[0m09:24:02.248522 [debug] [Thread-2  ]: Writing injected SQL for node "model.estudos_dbt.stg_football_rankings"
[0m09:24:02.257701 [debug] [Thread-1  ]: Writing injected SQL for node "model.estudos_dbt.stg_football_matches"
[0m09:24:02.260800 [debug] [Thread-2  ]: Timing info for model.estudos_dbt.stg_football_rankings (compile): 09:24:02.245335 => 09:24:02.259303
[0m09:24:02.263891 [debug] [Thread-2  ]: Began executing node model.estudos_dbt.stg_football_rankings
[0m09:24:02.270368 [debug] [Thread-1  ]: Timing info for model.estudos_dbt.stg_football_matches (compile): 09:24:02.235014 => 09:24:02.269926
[0m09:24:02.277150 [debug] [Thread-1  ]: Began executing node model.estudos_dbt.stg_football_matches
[0m09:24:02.343482 [debug] [Thread-1  ]: Writing runtime sql for node "model.estudos_dbt.stg_football_matches"
[0m09:24:02.346012 [debug] [Thread-2  ]: Writing runtime sql for node "model.estudos_dbt.stg_football_rankings"
[0m09:24:02.347214 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:24:02.348060 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:24:02.428783 [debug] [Thread-1  ]: On model.estudos_dbt.stg_football_matches: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.stg_football_matches"} */


  create or replace view `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
  OPTIONS()
  as SELECT * 
FROM estudos-dbt-e-bigquery.football.spi_matches_latest;


[0m09:24:02.430546 [debug] [Thread-2  ]: On model.estudos_dbt.stg_football_rankings: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.stg_football_rankings"} */


  create or replace view `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_rankings`
  OPTIONS()
  as SELECT * 
FROM estudos-dbt-e-bigquery.football.spi_global_ranking;


[0m09:24:03.547729 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:5fb583e4-9ff2-4696-8091-452d7db2bad9&page=queryresults
[0m09:24:03.549174 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:c1dcc256-7a98-4540-83a0-24b39d385c25&page=queryresults
[0m09:24:04.199139 [debug] [Thread-2  ]: Timing info for model.estudos_dbt.stg_football_rankings (execute): 09:24:02.264804 => 09:24:04.198825
[0m09:24:04.200919 [debug] [Thread-1  ]: Timing info for model.estudos_dbt.stg_football_matches (execute): 09:24:02.278004 => 09:24:04.200529
[0m09:24:04.202538 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd411f7e-cfbd-4e8f-895b-3c1b81678d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f791ed42730>]}
[0m09:24:04.203704 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd411f7e-cfbd-4e8f-895b-3c1b81678d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f791e979160>]}
[0m09:24:04.204828 [info ] [Thread-2  ]: 2 of 3 OK created sql view model dbt_football.stg_football_rankings ............ [[32mCREATE VIEW (0 processed)[0m in 1.97s]
[0m09:24:04.206204 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt_football.stg_football_matches ............. [[32mCREATE VIEW (0 processed)[0m in 1.97s]
[0m09:24:04.207547 [debug] [Thread-2  ]: Finished running node model.estudos_dbt.stg_football_rankings
[0m09:24:04.208563 [debug] [Thread-1  ]: Finished running node model.estudos_dbt.stg_football_matches
[0m09:24:04.209944 [debug] [Thread-4  ]: Began running node model.estudos_dbt.mart_football_information
[0m09:24:04.211259 [info ] [Thread-4  ]: 3 of 3 START sql view model dbt_football.mart_football_information ............. [RUN]
[0m09:24:04.213479 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.estudos_dbt.mart_football_information'
[0m09:24:04.214714 [debug] [Thread-4  ]: Began compiling node model.estudos_dbt.mart_football_information
[0m09:24:04.222884 [debug] [Thread-4  ]: Writing injected SQL for node "model.estudos_dbt.mart_football_information"
[0m09:24:04.224544 [debug] [Thread-4  ]: Timing info for model.estudos_dbt.mart_football_information (compile): 09:24:04.215434 => 09:24:04.224022
[0m09:24:04.227168 [debug] [Thread-4  ]: Began executing node model.estudos_dbt.mart_football_information
[0m09:24:04.236549 [debug] [Thread-4  ]: Writing runtime sql for node "model.estudos_dbt.mart_football_information"
[0m09:24:04.237618 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:24:04.287050 [debug] [Thread-4  ]: On model.estudos_dbt.mart_football_information: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.mart_football_information"} */


  create or replace view `estudos-dbt-e-bigquery`.`dbt_football`.`mart_football_information`
  OPTIONS()
  as with
  qryMatches as (
    SELECT * FROM `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches` where league = 'Barclays Premier League'
    ),
  qryRankings as (
    SELECT * FROM `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_rankings` where league = 'Barclays Premier League'
  ),

  qryFinal as (
    select
      qryMatches.season,
      qryMatches.date,
      qryMatches.league,
      qryMatches.team1,
      qryMatches.team2,
      team_one.rank as team1_rank,
      team_two.rank as team2_rank
    from
      qryMatches join
      qryRankings as team_one on
        (qryMatches.team1 = team_one.name) join
      qryRankings as team_two on
        (qryMatches.team2 = team_two.name)
  )

select * from qryFinal;


[0m09:24:05.492838 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:8dd7d8e3-f8fc-40e9-9016-ca3b17334e98&page=queryresults
[0m09:24:06.520112 [debug] [Thread-4  ]: Timing info for model.estudos_dbt.mart_football_information (execute): 09:24:04.228212 => 09:24:06.519620
[0m09:24:06.521710 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd411f7e-cfbd-4e8f-895b-3c1b81678d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f791ec43dc0>]}
[0m09:24:06.523207 [info ] [Thread-4  ]: 3 of 3 OK created sql view model dbt_football.mart_football_information ........ [[32mCREATE VIEW (0 processed)[0m in 2.31s]
[0m09:24:06.526040 [debug] [Thread-4  ]: Finished running node model.estudos_dbt.mart_football_information
[0m09:24:06.530955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:06.532328 [debug] [MainThread]: Connection 'model.estudos_dbt.stg_football_matches' was properly closed.
[0m09:24:06.533781 [debug] [MainThread]: Connection 'model.estudos_dbt.stg_football_rankings' was properly closed.
[0m09:24:06.534851 [debug] [MainThread]: Connection 'model.estudos_dbt.mart_football_information' was properly closed.
[0m09:24:06.535650 [info ] [MainThread]: 
[0m09:24:06.536330 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 6.10 seconds (6.10s).
[0m09:24:06.538346 [debug] [MainThread]: Command end result
[0m09:24:06.552051 [info ] [MainThread]: 
[0m09:24:06.553375 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:24:06.554600 [info ] [MainThread]: 
[0m09:24:06.555924 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:24:06.557741 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.7492714, "process_user_time": 5.781778, "process_kernel_time": 0.357594, "process_mem_max_rss": "189628", "process_out_blocks": "1872", "process_in_blocks": "0"}
[0m09:24:06.559631 [debug] [MainThread]: Command `dbt build` succeeded at 09:24:06.559116 after 7.75 seconds
[0m09:24:06.560948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793221c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f791f4ae100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f791f539d00>]}
[0m09:24:06.563819 [debug] [MainThread]: Flushing usage events
[0m09:43:39.910218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd6e779af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd6ca47640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd6ca47df0>]}


============================== 09:43:39.916437 | c837f387-e8a7-4887-9ab7-7b0765c7de8d ==============================
[0m09:43:39.916437 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:43:39.917399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:43:41.691017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c837f387-e8a7-4887-9ab7-7b0765c7de8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5bcb9c40>]}
[0m09:43:41.941279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c837f387-e8a7-4887-9ab7-7b0765c7de8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5b876cd0>]}
[0m09:43:41.945188 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m09:43:41.959997 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:43:42.061710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:43:42.062781 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:43:42.064285 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.football.marts
- models.football.staging
[0m09:43:42.077154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c837f387-e8a7-4887-9ab7-7b0765c7de8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5b180a60>]}
[0m09:43:42.108916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c837f387-e8a7-4887-9ab7-7b0765c7de8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5b1e0f70>]}
[0m09:43:42.110635 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:43:42.112538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c837f387-e8a7-4887-9ab7-7b0765c7de8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5b51e910>]}
[0m09:43:42.115380 [info ] [MainThread]: 
[0m09:43:42.117127 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:43:42.120088 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery'
[0m09:43:42.122171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:43:43.104911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery, now list_estudos-dbt-e-bigquery_dbt_football)
[0m09:43:43.106051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:43.795035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c837f387-e8a7-4887-9ab7-7b0765c7de8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5b51e820>]}
[0m09:43:43.796814 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:43:43.797846 [info ] [MainThread]: 
[0m09:43:43.807711 [debug] [Thread-1  ]: Began running node model.estudos_dbt.stg_football_matches
[0m09:43:43.810213 [debug] [Thread-2  ]: Began running node model.estudos_dbt.stg_football_rankings
[0m09:43:43.812424 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt_football.stg_football_matches .................. [RUN]
[0m09:43:43.817942 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now model.estudos_dbt.stg_football_matches)
[0m09:43:43.819980 [debug] [Thread-1  ]: Began compiling node model.estudos_dbt.stg_football_matches
[0m09:43:43.815131 [info ] [Thread-2  ]: 2 of 3 START sql view model dbt_football.stg_football_rankings ................. [RUN]
[0m09:43:43.833558 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.estudos_dbt.stg_football_rankings'
[0m09:43:43.840703 [debug] [Thread-2  ]: Began compiling node model.estudos_dbt.stg_football_rankings
[0m09:43:43.845699 [debug] [Thread-1  ]: Writing injected SQL for node "model.estudos_dbt.stg_football_matches"
[0m09:43:43.853410 [debug] [Thread-2  ]: Writing injected SQL for node "model.estudos_dbt.stg_football_rankings"
[0m09:43:43.856960 [debug] [Thread-2  ]: Timing info for model.estudos_dbt.stg_football_rankings (compile): 09:43:43.847197 => 09:43:43.855955
[0m09:43:43.859042 [debug] [Thread-2  ]: Began executing node model.estudos_dbt.stg_football_rankings
[0m09:43:43.860935 [debug] [Thread-1  ]: Timing info for model.estudos_dbt.stg_football_matches (compile): 09:43:43.821793 => 09:43:43.859881
[0m09:43:43.878415 [debug] [Thread-1  ]: Began executing node model.estudos_dbt.stg_football_matches
[0m09:43:43.968817 [debug] [Thread-1  ]: Writing runtime sql for node "model.estudos_dbt.stg_football_matches"
[0m09:43:43.967961 [debug] [Thread-2  ]: Writing runtime sql for node "model.estudos_dbt.stg_football_rankings"
[0m09:43:43.970149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:43:43.970909 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:43:44.051782 [debug] [Thread-2  ]: On model.estudos_dbt.stg_football_rankings: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.stg_football_rankings"} */


  create or replace view `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_rankings`
  OPTIONS()
  as SELECT * 
FROM estudos-dbt-e-bigquery.football.spi_global_ranking;


[0m09:43:44.052995 [debug] [Thread-1  ]: On model.estudos_dbt.stg_football_matches: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.stg_football_matches"} */


  create or replace view `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
  OPTIONS()
  as SELECT * 
FROM estudos-dbt-e-bigquery.football.spi_matches_latest;


[0m09:43:45.254321 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:2cacc333-7bfe-4825-92ae-af09ded2b4a0&page=queryresults
[0m09:43:45.293607 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:21f699ad-7bef-4eec-96e6-a52d5cd5a0dd&page=queryresults
[0m09:43:45.807742 [debug] [Thread-2  ]: Timing info for model.estudos_dbt.stg_football_rankings (execute): 09:43:43.862364 => 09:43:45.807435
[0m09:43:45.808892 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c837f387-e8a7-4887-9ab7-7b0765c7de8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5b0eaa00>]}
[0m09:43:45.809729 [info ] [Thread-2  ]: 2 of 3 OK created sql view model dbt_football.stg_football_rankings ............ [[32mCREATE VIEW (0 processed)[0m in 1.98s]
[0m09:43:45.810747 [debug] [Thread-2  ]: Finished running node model.estudos_dbt.stg_football_rankings
[0m09:43:45.817966 [debug] [Thread-1  ]: Timing info for model.estudos_dbt.stg_football_matches (execute): 09:43:43.883971 => 09:43:45.817491
[0m09:43:45.819235 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c837f387-e8a7-4887-9ab7-7b0765c7de8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5b0c9220>]}
[0m09:43:45.820512 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt_football.stg_football_matches ............. [[32mCREATE VIEW (0 processed)[0m in 2.00s]
[0m09:43:45.821693 [debug] [Thread-1  ]: Finished running node model.estudos_dbt.stg_football_matches
[0m09:43:45.826015 [debug] [Thread-4  ]: Began running node model.estudos_dbt.mart_football_information
[0m09:43:45.828432 [info ] [Thread-4  ]: 3 of 3 START sql view model dbt_football.mart_football_information ............. [RUN]
[0m09:43:45.830735 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.estudos_dbt.mart_football_information'
[0m09:43:45.831957 [debug] [Thread-4  ]: Began compiling node model.estudos_dbt.mart_football_information
[0m09:43:45.842325 [debug] [Thread-4  ]: Writing injected SQL for node "model.estudos_dbt.mart_football_information"
[0m09:43:45.845121 [debug] [Thread-4  ]: Timing info for model.estudos_dbt.mart_football_information (compile): 09:43:45.832633 => 09:43:45.844328
[0m09:43:45.846461 [debug] [Thread-4  ]: Began executing node model.estudos_dbt.mart_football_information
[0m09:43:45.856788 [debug] [Thread-4  ]: Writing runtime sql for node "model.estudos_dbt.mart_football_information"
[0m09:43:45.859471 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:43:45.938253 [debug] [Thread-4  ]: On model.estudos_dbt.mart_football_information: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.mart_football_information"} */


  create or replace view `estudos-dbt-e-bigquery`.`dbt_football`.`mart_football_information`
  OPTIONS()
  as with
  qryMatches as (
    SELECT * FROM `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches` where league = 'Barclays Premier League'
    ),
  qryRankings as (
    SELECT * FROM `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_rankings` where league = 'Barclays Premier League'
  ),

  qryFinal as (
    select
      qryMatches.season,
      qryMatches.date,
      qryMatches.league,
      qryMatches.team1,
      qryMatches.team2,
      team_one.rank as team1_rank,
      team_two.rank as team2_rank
    from
      qryMatches join
      qryRankings as team_one on
        (qryMatches.team1 = team_one.name) join
      qryRankings as team_two on
        (qryMatches.team2 = team_two.name)
  )

select * from qryFinal;


[0m09:43:46.994666 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:ee241a09-212d-4666-9eb2-dcdc85175f7a&page=queryresults
[0m09:43:47.611804 [debug] [Thread-4  ]: Timing info for model.estudos_dbt.mart_football_information (execute): 09:43:45.847246 => 09:43:47.611501
[0m09:43:47.612911 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c837f387-e8a7-4887-9ab7-7b0765c7de8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5b063fa0>]}
[0m09:43:47.613754 [info ] [Thread-4  ]: 3 of 3 OK created sql view model dbt_football.mart_football_information ........ [[32mCREATE VIEW (0 processed)[0m in 1.78s]
[0m09:43:47.614952 [debug] [Thread-4  ]: Finished running node model.estudos_dbt.mart_football_information
[0m09:43:47.617447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:43:47.618224 [debug] [MainThread]: Connection 'model.estudos_dbt.stg_football_matches' was properly closed.
[0m09:43:47.618655 [debug] [MainThread]: Connection 'model.estudos_dbt.stg_football_rankings' was properly closed.
[0m09:43:47.619067 [debug] [MainThread]: Connection 'model.estudos_dbt.mart_football_information' was properly closed.
[0m09:43:47.619666 [info ] [MainThread]: 
[0m09:43:47.620989 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.50 seconds (5.50s).
[0m09:43:47.623668 [debug] [MainThread]: Command end result
[0m09:43:47.657402 [info ] [MainThread]: 
[0m09:43:47.659534 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:43:47.660713 [info ] [MainThread]: 
[0m09:43:47.661812 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:43:47.663585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.844155, "process_user_time": 6.354583, "process_kernel_time": 0.438522, "process_mem_max_rss": "189580", "process_in_blocks": "23856", "process_out_blocks": "1864"}
[0m09:43:47.665100 [debug] [MainThread]: Command `dbt run` succeeded at 09:43:47.664666 after 7.85 seconds
[0m09:43:47.666093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd6e779af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5b98cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5b876cd0>]}
[0m09:43:47.666711 [debug] [MainThread]: Flushing usage events
[0m09:44:45.127649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e589ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e3b95a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e3b88f10>]}


============================== 09:44:45.130783 | d2b9b82d-eb12-4a4e-8e81-675bd0569417 ==============================
[0m09:44:45.130783 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:44:45.131659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:44:46.406073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2b9b82d-eb12-4a4e-8e81-675bd0569417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d2e4a340>]}
[0m09:44:46.606151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2b9b82d-eb12-4a4e-8e81-675bd0569417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d2710b80>]}
[0m09:44:46.610385 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m09:44:46.621129 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:44:46.667910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:44:46.668821 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:44:46.669630 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.football.marts
- models.football.staging
[0m09:44:46.676442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2b9b82d-eb12-4a4e-8e81-675bd0569417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d22c09d0>]}
[0m09:44:46.692932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2b9b82d-eb12-4a4e-8e81-675bd0569417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d2320f70>]}
[0m09:44:46.693608 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:44:46.694199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2b9b82d-eb12-4a4e-8e81-675bd0569417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d23dd8e0>]}
[0m09:44:46.695631 [info ] [MainThread]: 
[0m09:44:46.696410 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:44:46.698686 [debug] [MainThread]: Command end result
[0m09:44:46.711793 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.6697308, "process_user_time": 4.072178, "process_kernel_time": 0.364732, "process_mem_max_rss": "177932", "process_in_blocks": "16608", "process_out_blocks": "1792"}
[0m09:44:46.712687 [debug] [MainThread]: Command `dbt test` succeeded at 09:44:46.712409 after 1.67 seconds
[0m09:44:46.713474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46e589ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d277e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d2710b80>]}
[0m09:44:46.715428 [debug] [MainThread]: Flushing usage events
[0m09:48:55.189731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb2a9ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb0dde190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb0dda400>]}


============================== 09:48:55.192857 | 6d1bbcb3-72e6-488c-8151-1ea9561869d2 ==============================
[0m09:48:55.192857 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:48:55.193619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m09:48:56.367308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d1bbcb3-72e6-488c-8151-1ea9561869d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea00bad90>]}
[0m09:48:56.548926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d1bbcb3-72e6-488c-8151-1ea9561869d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9f949dc0>]}
[0m09:48:56.549871 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m09:48:56.563091 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:48:56.581772 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:48:56.582445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d1bbcb3-72e6-488c-8151-1ea9561869d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9fd00c10>]}
[0m09:48:57.994583 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.estudos_dbt.marts
- models.estudos_dbt.staging
[0m09:48:58.000502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d1bbcb3-72e6-488c-8151-1ea9561869d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9f17f760>]}
[0m09:48:58.024606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d1bbcb3-72e6-488c-8151-1ea9561869d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9f17fa00>]}
[0m09:48:58.025605 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:48:58.026358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d1bbcb3-72e6-488c-8151-1ea9561869d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9f886370>]}
[0m09:48:58.027833 [info ] [MainThread]: 
[0m09:48:58.028553 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:48:58.029665 [debug] [MainThread]: Command end result
[0m09:48:58.044196 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.9373562, "process_user_time": 5.288576, "process_kernel_time": 0.430095, "process_mem_max_rss": "183540", "process_in_blocks": "13624", "process_out_blocks": "2672"}
[0m09:48:58.045173 [debug] [MainThread]: Command `dbt test` succeeded at 09:48:58.044948 after 2.94 seconds
[0m09:48:58.046101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb2a9ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9f0b2f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9f9b1160>]}
[0m09:48:58.046968 [debug] [MainThread]: Flushing usage events
[0m09:49:26.730419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ee49ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ec797a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ec788ee0>]}


============================== 09:49:26.733528 | c9f756f6-d8ad-4a99-85b0-becda0b43b8c ==============================
[0m09:49:26.733528 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:49:26.734379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:49:27.877441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9f756f6-d8ad-4a99-85b0-becda0b43b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4db7bfa90>]}
[0m09:49:28.060515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9f756f6-d8ad-4a99-85b0-becda0b43b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4db7a2f70>]}
[0m09:49:28.061506 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m09:49:28.075009 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:49:28.092427 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:49:28.093088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c9f756f6-d8ad-4a99-85b0-becda0b43b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4db3f9910>]}
[0m09:49:29.514506 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m09:49:29.520325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9f756f6-d8ad-4a99-85b0-becda0b43b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4dab3e700>]}
[0m09:49:29.540287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9f756f6-d8ad-4a99-85b0-becda0b43b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4dab3eb20>]}
[0m09:49:29.540972 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:49:29.541592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9f756f6-d8ad-4a99-85b0-becda0b43b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4db733340>]}
[0m09:49:29.543098 [info ] [MainThread]: 
[0m09:49:29.543700 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:49:29.544413 [debug] [MainThread]: Command end result
[0m09:49:29.557017 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.9092684, "process_user_time": 5.295488, "process_kernel_time": 0.336221, "process_mem_max_rss": "183524", "process_out_blocks": "2680", "process_in_blocks": "0"}
[0m09:49:29.557833 [debug] [MainThread]: Command `dbt test` succeeded at 09:49:29.557632 after 2.91 seconds
[0m09:49:29.558478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ee49ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4db37ec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4db7a2f70>]}
[0m09:49:29.559050 [debug] [MainThread]: Flushing usage events
[0m09:51:48.714469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656265ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6560955a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6560946f10>]}


============================== 09:51:48.717575 | b96f8e3a-5fda-4050-8d4a-f4da840b52bf ==============================
[0m09:51:48.717575 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:51:48.718457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:51:49.857027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b96f8e3a-5fda-4050-8d4a-f4da840b52bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654f98d340>]}
[0m09:51:50.038564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b96f8e3a-5fda-4050-8d4a-f4da840b52bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654f490b80>]}
[0m09:51:50.039495 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m09:51:50.053014 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:51:50.071756 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:51:50.072685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b96f8e3a-5fda-4050-8d4a-f4da840b52bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654f569d60>]}
[0m09:51:51.486233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b96f8e3a-5fda-4050-8d4a-f4da840b52bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654ec53730>]}
[0m09:51:51.499286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b96f8e3a-5fda-4050-8d4a-f4da840b52bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654ec536a0>]}
[0m09:51:51.499940 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:51:51.500536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b96f8e3a-5fda-4050-8d4a-f4da840b52bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654f5df6a0>]}
[0m09:51:51.501900 [info ] [MainThread]: 
[0m09:51:51.502541 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:51:51.503288 [debug] [MainThread]: Command end result
[0m09:51:51.519515 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.8873248, "process_user_time": 5.302141, "process_kernel_time": 0.348403, "process_mem_max_rss": "183340", "process_out_blocks": "2688", "process_in_blocks": "0"}
[0m09:51:51.521257 [debug] [MainThread]: Command `dbt test` succeeded at 09:51:51.520815 after 2.89 seconds
[0m09:51:51.522223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656265ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654f4ead00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654f490b80>]}
[0m09:51:51.522826 [debug] [MainThread]: Flushing usage events
[0m09:52:02.713785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9fe2f9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9fc5c7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9fc5c7e20>]}


============================== 09:52:02.716968 | b39e99da-f1a8-4d2a-a296-745a0cb54335 ==============================
[0m09:52:02.716968 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:52:02.717816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:52:03.876987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b39e99da-f1a8-4d2a-a296-745a0cb54335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9fc601400>]}
[0m09:52:04.068695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b39e99da-f1a8-4d2a-a296-745a0cb54335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9eb1bbd90>]}
[0m09:52:04.069640 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m09:52:04.083352 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:52:04.133207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:04.133937 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:04.143496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b39e99da-f1a8-4d2a-a296-745a0cb54335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ead7ea90>]}
[0m09:52:04.159226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b39e99da-f1a8-4d2a-a296-745a0cb54335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ead61f40>]}
[0m09:52:04.159882 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:52:04.160522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b39e99da-f1a8-4d2a-a296-745a0cb54335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9eb0989a0>]}
[0m09:52:04.162356 [info ] [MainThread]: 
[0m09:52:04.163602 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:52:04.165318 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery'
[0m09:52:04.166477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:05.078787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery, now list_estudos-dbt-e-bigquery_dbt_football)
[0m09:52:05.080710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:05.789167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b39e99da-f1a8-4d2a-a296-745a0cb54335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9eb456eb0>]}
[0m09:52:05.791568 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:52:05.792153 [info ] [MainThread]: 
[0m09:52:05.794838 [debug] [Thread-1  ]: Began running node model.estudos_dbt.stg_football_matches
[0m09:52:05.795515 [debug] [Thread-2  ]: Began running node model.estudos_dbt.stg_football_rankings
[0m09:52:05.796381 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_football.stg_football_matches ................. [RUN]
[0m09:52:05.797324 [info ] [Thread-2  ]: 2 of 3 START sql table model dbt_football.stg_football_rankings ................ [RUN]
[0m09:52:05.799144 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now model.estudos_dbt.stg_football_matches)
[0m09:52:05.800845 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.estudos_dbt.stg_football_rankings'
[0m09:52:05.801881 [debug] [Thread-1  ]: Began compiling node model.estudos_dbt.stg_football_matches
[0m09:52:05.803047 [debug] [Thread-2  ]: Began compiling node model.estudos_dbt.stg_football_rankings
[0m09:52:05.820970 [debug] [Thread-1  ]: Writing injected SQL for node "model.estudos_dbt.stg_football_matches"
[0m09:52:05.826374 [debug] [Thread-2  ]: Writing injected SQL for node "model.estudos_dbt.stg_football_rankings"
[0m09:52:05.828448 [debug] [Thread-1  ]: Timing info for model.estudos_dbt.stg_football_matches (compile): 09:52:05.803521 => 09:52:05.827921
[0m09:52:05.829455 [debug] [Thread-1  ]: Began executing node model.estudos_dbt.stg_football_matches
[0m09:52:05.836503 [debug] [Thread-2  ]: Timing info for model.estudos_dbt.stg_football_rankings (compile): 09:52:05.814058 => 09:52:05.835742
[0m09:52:05.842424 [debug] [Thread-2  ]: Began executing node model.estudos_dbt.stg_football_rankings
[0m09:52:05.867903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:52:05.869514 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:52:07.390300 [debug] [Thread-1  ]: Writing runtime sql for node "model.estudos_dbt.stg_football_matches"
[0m09:52:07.393382 [debug] [Thread-2  ]: Writing runtime sql for node "model.estudos_dbt.stg_football_rankings"
[0m09:52:07.394771 [debug] [Thread-2  ]: On model.estudos_dbt.stg_football_rankings: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.stg_football_rankings"} */

  
    

    create or replace table `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_rankings`
      
    
    

    OPTIONS()
    as (
      SELECT * 
FROM estudos-dbt-e-bigquery.football.spi_global_ranking
    );
  
[0m09:52:07.396051 [debug] [Thread-1  ]: On model.estudos_dbt.stg_football_matches: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.stg_football_matches"} */

  
    

    create or replace table `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
      
    
    

    OPTIONS()
    as (
      SELECT * 
FROM estudos-dbt-e-bigquery.football.spi_matches_latest
    );
  
[0m09:52:08.043037 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:295a172f-d259-4747-bd52-f7d5efe98642&page=queryresults
[0m09:52:08.153973 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:b55b8530-7505-4424-8118-598a77affe32&page=queryresults
[0m09:52:10.336185 [debug] [Thread-2  ]: Timing info for model.estudos_dbt.stg_football_rankings (execute): 09:52:05.847984 => 09:52:10.335737
[0m09:52:10.337787 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b39e99da-f1a8-4d2a-a296-745a0cb54335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9eb456790>]}
[0m09:52:10.338894 [info ] [Thread-2  ]: 2 of 3 OK created sql table model dbt_football.stg_football_rankings ........... [[32mCREATE TABLE (640.0 rows, 47.9 KiB processed)[0m in 4.54s]
[0m09:52:10.339966 [debug] [Thread-2  ]: Finished running node model.estudos_dbt.stg_football_rankings
[0m09:52:11.326934 [debug] [Thread-1  ]: Timing info for model.estudos_dbt.stg_football_matches (execute): 09:52:05.830565 => 09:52:11.325970
[0m09:52:11.329990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b39e99da-f1a8-4d2a-a296-745a0cb54335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9eb445bb0>]}
[0m09:52:11.332334 [info ] [Thread-1  ]: 1 of 3 OK created sql table model dbt_football.stg_football_matches ............ [[32mCREATE TABLE (11.7k rows, 2.0 MiB processed)[0m in 5.53s]
[0m09:52:11.334748 [debug] [Thread-1  ]: Finished running node model.estudos_dbt.stg_football_matches
[0m09:52:11.337298 [debug] [Thread-4  ]: Began running node model.estudos_dbt.mart_football_information
[0m09:52:11.340097 [info ] [Thread-4  ]: 3 of 3 START sql table model dbt_football.mart_football_information ............ [RUN]
[0m09:52:11.345521 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.estudos_dbt.mart_football_information'
[0m09:52:11.347911 [debug] [Thread-4  ]: Began compiling node model.estudos_dbt.mart_football_information
[0m09:52:11.359037 [debug] [Thread-4  ]: Writing injected SQL for node "model.estudos_dbt.mart_football_information"
[0m09:52:11.362073 [debug] [Thread-4  ]: Timing info for model.estudos_dbt.mart_football_information (compile): 09:52:11.349761 => 09:52:11.360580
[0m09:52:11.364303 [debug] [Thread-4  ]: Began executing node model.estudos_dbt.mart_football_information
[0m09:52:11.373301 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:52:12.449825 [debug] [Thread-4  ]: Writing runtime sql for node "model.estudos_dbt.mart_football_information"
[0m09:52:12.450885 [debug] [Thread-4  ]: On model.estudos_dbt.mart_football_information: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.mart_football_information"} */

  
    

    create or replace table `estudos-dbt-e-bigquery`.`dbt_football`.`mart_football_information`
      
    
    

    OPTIONS()
    as (
      with
  qryMatches as (
    SELECT * FROM `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches` where league = 'Barclays Premier League'
    ),
  qryRankings as (
    SELECT * FROM `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_rankings` where league = 'Barclays Premier League'
  ),

  qryFinal as (
    select
      qryMatches.season,
      qryMatches.date,
      qryMatches.league,
      qryMatches.team1,
      qryMatches.team2,
      team_one.rank as team1_rank,
      team_two.rank as team2_rank
    from
      qryMatches join
      qryRankings as team_one on
        (qryMatches.team1 = team_one.name) join
      qryRankings as team_two on
        (qryMatches.team2 = team_two.name)
  )

select * from qryFinal
    );
  
[0m09:52:13.061303 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:600e8a3b-0ef7-428e-889b-27d589ba59e2&page=queryresults
[0m09:52:15.726758 [debug] [Thread-4  ]: Timing info for model.estudos_dbt.mart_football_information (execute): 09:52:11.365771 => 09:52:15.726451
[0m09:52:15.727929 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b39e99da-f1a8-4d2a-a296-745a0cb54335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ea9fdc10>]}
[0m09:52:15.728768 [info ] [Thread-4  ]: 3 of 3 OK created sql table model dbt_football.mart_football_information ....... [[32mCREATE TABLE (380.0 rows, 786.5 KiB processed)[0m in 4.39s]
[0m09:52:15.729646 [debug] [Thread-4  ]: Finished running node model.estudos_dbt.mart_football_information
[0m09:52:15.732322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:15.733274 [debug] [MainThread]: Connection 'model.estudos_dbt.stg_football_matches' was properly closed.
[0m09:52:15.734150 [debug] [MainThread]: Connection 'model.estudos_dbt.stg_football_rankings' was properly closed.
[0m09:52:15.734724 [debug] [MainThread]: Connection 'model.estudos_dbt.mart_football_information' was properly closed.
[0m09:52:15.735879 [info ] [MainThread]: 
[0m09:52:15.737105 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.57 seconds (11.57s).
[0m09:52:15.739915 [debug] [MainThread]: Command end result
[0m09:52:15.756672 [info ] [MainThread]: 
[0m09:52:15.757352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:52:15.758018 [info ] [MainThread]: 
[0m09:52:15.758641 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:52:15.759391 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.130319, "process_user_time": 5.583516, "process_kernel_time": 0.440277, "process_mem_max_rss": "189788", "process_out_blocks": "1872", "process_in_blocks": "0"}
[0m09:52:15.760144 [debug] [MainThread]: Command `dbt run` succeeded at 09:52:15.759955 after 13.13 seconds
[0m09:52:15.761303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9fe2f9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9eb5708b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9eb1bbd90>]}
[0m09:52:15.763859 [debug] [MainThread]: Flushing usage events
[0m11:10:27.118570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3dbc5ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d9f6aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d9f5cf10>]}


============================== 11:10:27.122753 | 85cdecc7-e741-42c0-9dc8-644623feac6a ==============================
[0m11:10:27.122753 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:10:27.123573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'debug': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:10:28.404685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85cdecc7-e741-42c0-9dc8-644623feac6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c924c340>]}
[0m11:10:28.593770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85cdecc7-e741-42c0-9dc8-644623feac6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c8b10b80>]}
[0m11:10:28.597395 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m11:10:28.607674 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:10:28.660844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:10:28.661616 [debug] [MainThread]: Partial parsing: added file: estudos_dbt://models/football/staging/sources.yml
[0m11:10:28.662317 [debug] [MainThread]: Partial parsing: updated file: estudos_dbt://models/football/staging/stg_football_matches.sql
[0m11:10:29.158171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85cdecc7-e741-42c0-9dc8-644623feac6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c7e55dc0>]}
[0m11:10:29.237688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85cdecc7-e741-42c0-9dc8-644623feac6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c82ad310>]}
[0m11:10:29.238531 [info ] [MainThread]: Found 3 models, 2 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:10:29.239319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85cdecc7-e741-42c0-9dc8-644623feac6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c82ad220>]}
[0m11:10:29.241068 [info ] [MainThread]: 
[0m11:10:29.241752 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:10:29.242672 [debug] [MainThread]: Command end result
[0m11:10:29.256063 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.2273304, "process_user_time": 4.438202, "process_kernel_time": 0.388894, "process_mem_max_rss": "184560", "process_in_blocks": "28872", "process_out_blocks": "2688"}
[0m11:10:29.257214 [debug] [MainThread]: Command `dbt test` succeeded at 11:10:29.256958 after 2.23 seconds
[0m11:10:29.257890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3dbc5ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c8b78d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c82add60>]}
[0m11:10:29.258552 [debug] [MainThread]: Flushing usage events
[0m11:11:09.500361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f925631ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92545fa190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92545f6400>]}


============================== 11:11:09.503544 | d0c20f64-c596-4cac-9066-b6f00a2a1dae ==============================
[0m11:11:09.503544 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:11:09.504346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:11:10.662350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0c20f64-c596-4cac-9066-b6f00a2a1dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92438caca0>]}
[0m11:11:10.851985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0c20f64-c596-4cac-9066-b6f00a2a1dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9243189dc0>]}
[0m11:11:10.852869 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m11:11:10.863109 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:11:10.914175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:11:10.915474 [debug] [MainThread]: Partial parsing: updated file: estudos_dbt://models/football/staging/stg_football_rankings.sql
[0m11:11:11.280896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0c20f64-c596-4cac-9066-b6f00a2a1dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f924292c760>]}
[0m11:11:11.294188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0c20f64-c596-4cac-9066-b6f00a2a1dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92430f4370>]}
[0m11:11:11.294850 [info ] [MainThread]: Found 3 models, 2 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:11:11.295397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0c20f64-c596-4cac-9066-b6f00a2a1dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92430f4f40>]}
[0m11:11:11.297131 [info ] [MainThread]: 
[0m11:11:11.298183 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:11:11.299800 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery'
[0m11:11:11.300353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:12.183893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery, now list_estudos-dbt-e-bigquery_dbt_football)
[0m11:11:12.185708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:12.993378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0c20f64-c596-4cac-9066-b6f00a2a1dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9243553c10>]}
[0m11:11:12.994945 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:11:12.995708 [info ] [MainThread]: 
[0m11:11:12.998937 [debug] [Thread-1  ]: Began running node model.estudos_dbt.stg_football_matches
[0m11:11:12.999885 [debug] [Thread-2  ]: Began running node model.estudos_dbt.stg_football_rankings
[0m11:11:13.000619 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_football.stg_football_matches ................. [RUN]
[0m11:11:13.002017 [info ] [Thread-2  ]: 2 of 3 START sql table model dbt_football.stg_football_rankings ................ [RUN]
[0m11:11:13.003774 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now model.estudos_dbt.stg_football_matches)
[0m11:11:13.005579 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.estudos_dbt.stg_football_rankings'
[0m11:11:13.006741 [debug] [Thread-1  ]: Began compiling node model.estudos_dbt.stg_football_matches
[0m11:11:13.007752 [debug] [Thread-2  ]: Began compiling node model.estudos_dbt.stg_football_rankings
[0m11:11:13.029772 [debug] [Thread-2  ]: Writing injected SQL for node "model.estudos_dbt.stg_football_rankings"
[0m11:11:13.038166 [debug] [Thread-2  ]: Timing info for model.estudos_dbt.stg_football_rankings (compile): 11:11:13.018935 => 11:11:13.037738
[0m11:11:13.038796 [debug] [Thread-2  ]: Began executing node model.estudos_dbt.stg_football_rankings
[0m11:11:13.042245 [debug] [Thread-1  ]: Writing injected SQL for node "model.estudos_dbt.stg_football_matches"
[0m11:11:13.140646 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:11:13.141832 [debug] [Thread-1  ]: Timing info for model.estudos_dbt.stg_football_matches (compile): 11:11:13.008665 => 11:11:13.141412
[0m11:11:13.142499 [debug] [Thread-1  ]: Began executing node model.estudos_dbt.stg_football_matches
[0m11:11:13.145366 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:11:14.202708 [debug] [Thread-2  ]: Writing runtime sql for node "model.estudos_dbt.stg_football_rankings"
[0m11:11:14.203733 [debug] [Thread-1  ]: Writing runtime sql for node "model.estudos_dbt.stg_football_matches"
[0m11:11:14.204935 [debug] [Thread-2  ]: On model.estudos_dbt.stg_football_rankings: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.stg_football_rankings"} */

  
    

    create or replace table `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_rankings`
      
    
    

    OPTIONS()
    as (
      SELECT * 
FROM `football`.`staging`.`spi_global_ranking`
    );
  
[0m11:11:14.207755 [debug] [Thread-1  ]: On model.estudos_dbt.stg_football_matches: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.stg_football_matches"} */

  
    

    create or replace table `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
      
    
    

    OPTIONS()
    as (
      SELECT * 
FROM `football`.`staging`.`spi_matches_latest`
    );
  
[0m11:11:14.742884 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:425b5720-8abb-405d-bad7-887e343a22e1&page=queryresults
[0m11:11:14.745486 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:8ffd1474-17f9-42dd-ad53-69b54644a416&page=queryresults
[0m11:11:14.752249 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:8ffd1474-17f9-42dd-ad53-69b54644a416&page=queryresults
[0m11:11:14.754713 [error] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:425b5720-8abb-405d-bad7-887e343a22e1&page=queryresults
[0m11:11:14.756120 [debug] [Thread-1  ]: Timing info for model.estudos_dbt.stg_football_matches (execute): 11:11:13.142839 => 11:11:14.755775
[0m11:11:14.756913 [debug] [Thread-2  ]: Timing info for model.estudos_dbt.stg_football_rankings (execute): 11:11:13.042717 => 11:11:14.756599
[0m11:11:14.775597 [debug] [Thread-2  ]: Database Error in model stg_football_rankings (models/football/staging/stg_football_rankings.sql)
  Access Denied: Table football:staging.spi_global_ranking: User does not have permission to query table football:staging.spi_global_ranking, or perhaps it does not exist in location US.
  compiled Code at target/run/estudos_dbt/models/football/staging/stg_football_rankings.sql
[0m11:11:14.779205 [debug] [Thread-1  ]: Database Error in model stg_football_matches (models/football/staging/stg_football_matches.sql)
  Access Denied: Table football:staging.spi_matches_latest: User does not have permission to query table football:staging.spi_matches_latest, or perhaps it does not exist in location US.
  compiled Code at target/run/estudos_dbt/models/football/staging/stg_football_matches.sql
[0m11:11:14.780839 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c20f64-c596-4cac-9066-b6f00a2a1dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92425868e0>]}
[0m11:11:14.782872 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c20f64-c596-4cac-9066-b6f00a2a1dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92429ae400>]}
[0m11:11:14.784313 [error] [Thread-2  ]: 2 of 3 ERROR creating sql table model dbt_football.stg_football_rankings ....... [[31mERROR[0m in 1.78s]
[0m11:11:14.785899 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model dbt_football.stg_football_matches ........ [[31mERROR[0m in 1.78s]
[0m11:11:14.787222 [debug] [Thread-2  ]: Finished running node model.estudos_dbt.stg_football_rankings
[0m11:11:14.788221 [debug] [Thread-1  ]: Finished running node model.estudos_dbt.stg_football_matches
[0m11:11:14.789716 [debug] [Thread-4  ]: Began running node model.estudos_dbt.mart_football_information
[0m11:11:14.790644 [info ] [Thread-4  ]: 3 of 3 SKIP relation dbt_football.mart_football_information .................... [[33mSKIP[0m]
[0m11:11:14.791568 [debug] [Thread-4  ]: Finished running node model.estudos_dbt.mart_football_information
[0m11:11:14.794507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:14.798715 [debug] [MainThread]: Connection 'model.estudos_dbt.stg_football_matches' was properly closed.
[0m11:11:14.799943 [debug] [MainThread]: Connection 'model.estudos_dbt.stg_football_rankings' was properly closed.
[0m11:11:14.801089 [info ] [MainThread]: 
[0m11:11:14.802458 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m11:11:14.804938 [debug] [MainThread]: Command end result
[0m11:11:14.821311 [info ] [MainThread]: 
[0m11:11:14.822555 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:11:14.823447 [info ] [MainThread]: 
[0m11:11:14.824038 [error] [MainThread]:   Database Error in model stg_football_rankings (models/football/staging/stg_football_rankings.sql)
  Access Denied: Table football:staging.spi_global_ranking: User does not have permission to query table football:staging.spi_global_ranking, or perhaps it does not exist in location US.
  compiled Code at target/run/estudos_dbt/models/football/staging/stg_football_rankings.sql
[0m11:11:14.824731 [info ] [MainThread]: 
[0m11:11:14.825597 [error] [MainThread]:   Database Error in model stg_football_matches (models/football/staging/stg_football_matches.sql)
  Access Denied: Table football:staging.spi_matches_latest: User does not have permission to query table football:staging.spi_matches_latest, or perhaps it does not exist in location US.
  compiled Code at target/run/estudos_dbt/models/football/staging/stg_football_matches.sql
[0m11:11:14.826419 [info ] [MainThread]: 
[0m11:11:14.827552 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m11:11:14.830489 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.414098, "process_user_time": 5.753876, "process_kernel_time": 0.48248, "process_mem_max_rss": "194260", "process_in_blocks": "1040", "process_out_blocks": "2736", "command_success": false}
[0m11:11:14.833119 [debug] [MainThread]: Command `dbt run` failed at 11:11:14.832229 after 5.42 seconds
[0m11:11:14.834952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f925631ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9242d33e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92438ab5e0>]}
[0m11:11:14.836122 [debug] [MainThread]: Flushing usage events
[0m11:12:54.074607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8f6b9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8d988670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8d988e20>]}


============================== 11:12:54.077675 | d0d10216-2bc0-439a-b9f3-9fc984252ff7 ==============================
[0m11:12:54.077675 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:12:54.078485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:12:55.234347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0d10216-2bc0-439a-b9f3-9fc984252ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8d9c3400>]}
[0m11:12:55.416040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0d10216-2bc0-439a-b9f3-9fc984252ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e7c57bd90>]}
[0m11:12:55.416930 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m11:12:55.427486 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:12:55.475370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:12:55.476391 [debug] [MainThread]: Partial parsing: updated file: estudos_dbt://models/football/staging/sources.yml
[0m11:12:55.974342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0d10216-2bc0-439a-b9f3-9fc984252ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e7b850280>]}
[0m11:12:56.057351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0d10216-2bc0-439a-b9f3-9fc984252ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e7bc9c4c0>]}
[0m11:12:56.058213 [info ] [MainThread]: Found 3 models, 2 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:12:56.058930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0d10216-2bc0-439a-b9f3-9fc984252ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e7bc9cbb0>]}
[0m11:12:56.061016 [info ] [MainThread]: 
[0m11:12:56.062906 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:12:56.066023 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery'
[0m11:12:56.067432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:56.939852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery, now list_estudos-dbt-e-bigquery_dbt_football)
[0m11:12:56.940978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:57.864321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0d10216-2bc0-439a-b9f3-9fc984252ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e7bc9cac0>]}
[0m11:12:57.867882 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:12:57.870188 [info ] [MainThread]: 
[0m11:12:57.880090 [debug] [Thread-1  ]: Began running node model.estudos_dbt.stg_football_matches
[0m11:12:57.882212 [debug] [Thread-2  ]: Began running node model.estudos_dbt.stg_football_rankings
[0m11:12:57.885717 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_football.stg_football_matches ................. [RUN]
[0m11:12:57.895217 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now model.estudos_dbt.stg_football_matches)
[0m11:12:57.890276 [info ] [Thread-2  ]: 2 of 3 START sql table model dbt_football.stg_football_rankings ................ [RUN]
[0m11:12:57.897792 [debug] [Thread-1  ]: Began compiling node model.estudos_dbt.stg_football_matches
[0m11:12:57.901461 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.estudos_dbt.stg_football_rankings'
[0m11:12:57.919653 [debug] [Thread-2  ]: Began compiling node model.estudos_dbt.stg_football_rankings
[0m11:12:57.929534 [debug] [Thread-2  ]: Writing injected SQL for node "model.estudos_dbt.stg_football_rankings"
[0m11:12:57.930294 [debug] [Thread-1  ]: Writing injected SQL for node "model.estudos_dbt.stg_football_matches"
[0m11:12:57.931275 [debug] [Thread-1  ]: Timing info for model.estudos_dbt.stg_football_matches (compile): 11:12:57.903118 => 11:12:57.930861
[0m11:12:57.932612 [debug] [Thread-1  ]: Began executing node model.estudos_dbt.stg_football_matches
[0m11:12:57.940380 [debug] [Thread-2  ]: Timing info for model.estudos_dbt.stg_football_rankings (compile): 11:12:57.925892 => 11:12:57.939744
[0m11:12:57.946494 [debug] [Thread-2  ]: Began executing node model.estudos_dbt.stg_football_rankings
[0m11:12:57.979738 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:12:57.988688 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:12:59.127061 [debug] [Thread-1  ]: Writing runtime sql for node "model.estudos_dbt.stg_football_matches"
[0m11:12:59.129097 [debug] [Thread-2  ]: Writing runtime sql for node "model.estudos_dbt.stg_football_rankings"
[0m11:12:59.131524 [debug] [Thread-1  ]: On model.estudos_dbt.stg_football_matches: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.stg_football_matches"} */

  
    

    create or replace table `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
      
    
    

    OPTIONS()
    as (
      SELECT * 
FROM `estudos-dbt-e-bigquery`.`football`.`spi_matches_latest`
    );
  
[0m11:12:59.133191 [debug] [Thread-2  ]: On model.estudos_dbt.stg_football_rankings: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.stg_football_rankings"} */

  
    

    create or replace table `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_rankings`
      
    
    

    OPTIONS()
    as (
      SELECT * 
FROM `estudos-dbt-e-bigquery`.`football`.`spi_global_ranking`
    );
  
[0m11:12:59.704284 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:10dad131-390d-47c2-93c7-17ee25658d01&page=queryresults
[0m11:12:59.724920 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:8fb9bd96-823c-4a60-87f5-b1f483cf24ec&page=queryresults
[0m11:13:01.998647 [debug] [Thread-2  ]: Timing info for model.estudos_dbt.stg_football_rankings (execute): 11:12:57.946926 => 11:13:01.998285
[0m11:13:02.000068 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0d10216-2bc0-439a-b9f3-9fc984252ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e7c0e3160>]}
[0m11:13:02.005089 [debug] [Thread-1  ]: Timing info for model.estudos_dbt.stg_football_matches (execute): 11:12:57.934645 => 11:13:02.004554
[0m11:13:02.001079 [info ] [Thread-2  ]: 2 of 3 OK created sql table model dbt_football.stg_football_rankings ........... [[32mCREATE TABLE (640.0 rows, 47.9 KiB processed)[0m in 4.10s]
[0m11:13:02.006605 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0d10216-2bc0-439a-b9f3-9fc984252ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e7c08c760>]}
[0m11:13:02.008266 [debug] [Thread-2  ]: Finished running node model.estudos_dbt.stg_football_rankings
[0m11:13:02.010400 [info ] [Thread-1  ]: 1 of 3 OK created sql table model dbt_football.stg_football_matches ............ [[32mCREATE TABLE (11.7k rows, 2.0 MiB processed)[0m in 4.11s]
[0m11:13:02.013071 [debug] [Thread-1  ]: Finished running node model.estudos_dbt.stg_football_matches
[0m11:13:02.014749 [debug] [Thread-4  ]: Began running node model.estudos_dbt.mart_football_information
[0m11:13:02.016419 [info ] [Thread-4  ]: 3 of 3 START sql table model dbt_football.mart_football_information ............ [RUN]
[0m11:13:02.019096 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.estudos_dbt.mart_football_information'
[0m11:13:02.020515 [debug] [Thread-4  ]: Began compiling node model.estudos_dbt.mart_football_information
[0m11:13:02.028906 [debug] [Thread-4  ]: Writing injected SQL for node "model.estudos_dbt.mart_football_information"
[0m11:13:02.029940 [debug] [Thread-4  ]: Timing info for model.estudos_dbt.mart_football_information (compile): 11:13:02.022645 => 11:13:02.029598
[0m11:13:02.030962 [debug] [Thread-4  ]: Began executing node model.estudos_dbt.mart_football_information
[0m11:13:02.038322 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:13:02.880994 [debug] [Thread-4  ]: Writing runtime sql for node "model.estudos_dbt.mart_football_information"
[0m11:13:02.882004 [debug] [Thread-4  ]: On model.estudos_dbt.mart_football_information: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "model.estudos_dbt.mart_football_information"} */

  
    

    create or replace table `estudos-dbt-e-bigquery`.`dbt_football`.`mart_football_information`
      
    
    

    OPTIONS()
    as (
      with
  qryMatches as (
    SELECT * FROM `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches` where league = 'Barclays Premier League'
    ),
  qryRankings as (
    SELECT * FROM `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_rankings` where league = 'Barclays Premier League'
  ),

  qryFinal as (
    select
      qryMatches.season,
      qryMatches.date,
      qryMatches.league,
      qryMatches.team1,
      qryMatches.team2,
      team_one.rank as team1_rank,
      team_two.rank as team2_rank
    from
      qryMatches join
      qryRankings as team_one on
        (qryMatches.team1 = team_one.name) join
      qryRankings as team_two on
        (qryMatches.team2 = team_two.name)
  )

select * from qryFinal
    );
  
[0m11:13:03.493410 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:52436394-70cd-4f89-9bbe-4c19ec5604e5&page=queryresults
[0m11:13:05.849624 [debug] [Thread-4  ]: Timing info for model.estudos_dbt.mart_football_information (execute): 11:13:02.031564 => 11:13:05.849316
[0m11:13:05.850788 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0d10216-2bc0-439a-b9f3-9fc984252ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e7bcc8c40>]}
[0m11:13:05.851651 [info ] [Thread-4  ]: 3 of 3 OK created sql table model dbt_football.mart_football_information ....... [[32mCREATE TABLE (380.0 rows, 786.5 KiB processed)[0m in 3.83s]
[0m11:13:05.852557 [debug] [Thread-4  ]: Finished running node model.estudos_dbt.mart_football_information
[0m11:13:05.855037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:05.855963 [debug] [MainThread]: Connection 'model.estudos_dbt.stg_football_matches' was properly closed.
[0m11:13:05.856787 [debug] [MainThread]: Connection 'model.estudos_dbt.stg_football_rankings' was properly closed.
[0m11:13:05.857532 [debug] [MainThread]: Connection 'model.estudos_dbt.mart_football_information' was properly closed.
[0m11:13:05.858341 [info ] [MainThread]: 
[0m11:13:05.859310 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 9.80 seconds (9.80s).
[0m11:13:05.861020 [debug] [MainThread]: Command end result
[0m11:13:05.888765 [info ] [MainThread]: 
[0m11:13:05.890003 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:13:05.891049 [info ] [MainThread]: 
[0m11:13:05.892052 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:13:05.893223 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.902029, "process_user_time": 6.351504, "process_kernel_time": 0.506833, "process_mem_max_rss": "197260", "process_out_blocks": "2792", "process_in_blocks": "0"}
[0m11:13:05.894602 [debug] [MainThread]: Command `dbt run` succeeded at 11:13:05.894340 after 11.90 seconds
[0m11:13:05.895296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8f6b9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e7c8c54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e7c57bd90>]}
[0m11:13:05.895966 [debug] [MainThread]: Flushing usage events
[0m11:19:32.871696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb66dca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb49c46a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb49c4e50>]}


============================== 11:19:32.876633 | cdd75e6d-a343-4c39-a8cb-672b2774b136 ==============================
[0m11:19:32.876633 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:19:32.877854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt source freshness', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:19:34.047805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdd75e6d-a343-4c39-a8cb-672b2774b136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea4cca790>]}
[0m11:19:34.282338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdd75e6d-a343-4c39-a8cb-672b2774b136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea398f0a0>]}
[0m11:19:34.283220 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m11:19:34.294743 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:19:34.342561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:19:34.343885 [debug] [MainThread]: Partial parsing: updated file: estudos_dbt://models/football/staging/sources.yml
[0m11:19:34.856630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdd75e6d-a343-4c39-a8cb-672b2774b136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea2959370>]}
[0m11:19:34.936961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdd75e6d-a343-4c39-a8cb-672b2774b136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea2cdd340>]}
[0m11:19:34.937754 [info ] [MainThread]: Found 3 models, 2 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:19:34.938539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd75e6d-a343-4c39-a8cb-672b2774b136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea2cdd6d0>]}
[0m11:19:34.940538 [info ] [MainThread]: 
[0m11:19:34.941753 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:19:34.943627 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery_dbt_football'
[0m11:19:34.944910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:35.793598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd75e6d-a343-4c39-a8cb-672b2774b136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea2cdb0d0>]}
[0m11:19:35.796725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:19:35.798462 [info ] [MainThread]: 
[0m11:19:35.806650 [debug] [Thread-1  ]: Began running node source.estudos_dbt.spi.spi_matches_latest
[0m11:19:35.808680 [info ] [Thread-1  ]: 1 of 1 START freshness of spi.spi_matches_latest ............................... [RUN]
[0m11:19:35.811526 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now source.estudos_dbt.spi.spi_matches_latest)
[0m11:19:35.813421 [debug] [Thread-1  ]: Began compiling node source.estudos_dbt.spi.spi_matches_latest
[0m11:19:35.815638 [debug] [Thread-1  ]: Timing info for source.estudos_dbt.spi.spi_matches_latest (compile): 11:19:35.814619 => 11:19:35.814635
[0m11:19:35.817793 [debug] [Thread-1  ]: Began executing node source.estudos_dbt.spi.spi_matches_latest
[0m11:19:35.847975 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:19:35.897230 [debug] [Thread-1  ]: On source.estudos_dbt.spi.spi_matches_latest: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "source.estudos_dbt.spi.spi_matches_latest"} */
select
      max(CAST(date AS TIMESTAMP)) as max_loaded_at,
      current_timestamp() as snapshotted_at
    from `estudos-dbt-e-bigquery`.`football`.`spi_matches_latest`
    
  
[0m11:19:37.325716 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:eb739188-d349-44b7-abde-5504de7d8c33&page=queryresults
[0m11:19:38.350947 [debug] [Thread-1  ]: Timing info for source.estudos_dbt.spi.spi_matches_latest (execute): 11:19:35.818948 => 11:19:38.349780
[0m11:19:38.352398 [error] [Thread-1  ]: 1 of 1 ERROR STALE freshness of spi.spi_matches_latest ......................... [[31mERROR STALE[0m in 2.54s]
[0m11:19:38.353445 [debug] [Thread-1  ]: Finished running node source.estudos_dbt.spi.spi_matches_latest
[0m11:19:38.354852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:19:38.355706 [debug] [MainThread]: Connection 'source.estudos_dbt.spi.spi_matches_latest' was properly closed.
[0m11:19:38.366899 [info ] [MainThread]: 
[0m11:19:38.368274 [info ] [MainThread]: Done.
[0m11:19:38.369677 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 5.5817547, "process_user_time": 5.067072, "process_kernel_time": 0.413884, "process_mem_max_rss": "192320", "process_out_blocks": "2696", "command_success": false, "process_in_blocks": "0"}
[0m11:19:38.372281 [debug] [MainThread]: Command `dbt source freshness` failed at 11:19:38.371821 after 5.58 seconds
[0m11:19:38.373632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb66dca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea2c5f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea313cc70>]}
[0m11:19:38.374993 [debug] [MainThread]: Flushing usage events
[0m11:20:59.061065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ce0c79af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cdef3e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cdef3eee0>]}


============================== 11:20:59.064256 | 24c1c563-e7ff-4572-a692-e3c554944883 ==============================
[0m11:20:59.064256 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:20:59.065062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'debug': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt source freshness', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:21:00.235757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24c1c563-e7ff-4572-a692-e3c554944883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cdef9b490>]}
[0m11:21:00.436447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24c1c563-e7ff-4572-a692-e3c554944883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ccda870a0>]}
[0m11:21:00.437407 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m11:21:00.452377 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:21:00.511002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:21:00.512200 [debug] [MainThread]: Partial parsing: updated file: estudos_dbt://models/football/staging/sources.yml
[0m11:21:01.028260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24c1c563-e7ff-4572-a692-e3c554944883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cccb933a0>]}
[0m11:21:01.109315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24c1c563-e7ff-4572-a692-e3c554944883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cccfdec40>]}
[0m11:21:01.110116 [info ] [MainThread]: Found 3 models, 2 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:21:01.111012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24c1c563-e7ff-4572-a692-e3c554944883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cccfdef10>]}
[0m11:21:01.113022 [info ] [MainThread]: 
[0m11:21:01.114548 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:21:01.116274 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery_dbt_football'
[0m11:21:01.116967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:01.913755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24c1c563-e7ff-4572-a692-e3c554944883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cccfda7c0>]}
[0m11:21:01.917285 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:21:01.919400 [info ] [MainThread]: 
[0m11:21:01.930381 [debug] [Thread-1  ]: Began running node source.estudos_dbt.spi.spi_matches_latest
[0m11:21:01.932710 [info ] [Thread-1  ]: 1 of 1 START freshness of spi.spi_matches_latest ............................... [RUN]
[0m11:21:01.936223 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now source.estudos_dbt.spi.spi_matches_latest)
[0m11:21:01.938577 [debug] [Thread-1  ]: Began compiling node source.estudos_dbt.spi.spi_matches_latest
[0m11:21:01.941347 [debug] [Thread-1  ]: Timing info for source.estudos_dbt.spi.spi_matches_latest (compile): 11:21:01.940047 => 11:21:01.940064
[0m11:21:01.944221 [debug] [Thread-1  ]: Began executing node source.estudos_dbt.spi.spi_matches_latest
[0m11:21:01.972397 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:21:02.018584 [debug] [Thread-1  ]: On source.estudos_dbt.spi.spi_matches_latest: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "source.estudos_dbt.spi.spi_matches_latest"} */
select
      max(CAST(date AS TIMESTAMP)) as max_loaded_at,
      current_timestamp() as snapshotted_at
    from `estudos-dbt-e-bigquery`.`football`.`spi_matches_latest`
    
  
[0m11:21:03.113557 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:b6112a4e-4d2d-4053-917f-5f8aa45e47b1&page=queryresults
[0m11:21:04.061331 [debug] [Thread-1  ]: Timing info for source.estudos_dbt.spi.spi_matches_latest (execute): 11:21:01.945588 => 11:21:04.060128
[0m11:21:04.064847 [warn ] [Thread-1  ]: 1 of 1 WARN freshness of spi.spi_matches_latest ................................ [[33mWARN[0m in 2.13s]
[0m11:21:04.068040 [debug] [Thread-1  ]: Finished running node source.estudos_dbt.spi.spi_matches_latest
[0m11:21:04.071930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:21:04.074276 [debug] [MainThread]: Connection 'source.estudos_dbt.spi.spi_matches_latest' was properly closed.
[0m11:21:04.107173 [info ] [MainThread]: Done.
[0m11:21:04.111142 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 5.134441, "process_user_time": 5.198705, "process_kernel_time": 0.363071, "process_mem_max_rss": "192292", "process_out_blocks": "2696", "process_in_blocks": "0"}
[0m11:21:04.115056 [debug] [MainThread]: Command `dbt source freshness` succeeded at 11:21:04.113631 after 5.14 seconds
[0m11:21:04.116404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ce0c79af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ccde7c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ccda870a0>]}
[0m11:21:04.117736 [debug] [MainThread]: Flushing usage events
[0m11:52:11.960539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1998f9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc197bab670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc197babe20>]}


============================== 11:52:11.963677 | 404225b8-c37c-422d-be74-0fc53d01ebc0 ==============================
[0m11:52:11.963677 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:52:11.964475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:52:13.138649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '404225b8-c37c-422d-be74-0fc53d01ebc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc197be6400>]}
[0m11:52:13.337448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '404225b8-c37c-422d-be74-0fc53d01ebc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1867bbd90>]}
[0m11:52:13.338433 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m11:52:13.350006 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:52:13.405803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:52:13.407198 [debug] [MainThread]: Partial parsing: updated file: estudos_dbt://models/football/staging/schema.yml
[0m11:52:13.940500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '404225b8-c37c-422d-be74-0fc53d01ebc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc185a5deb0>]}
[0m11:52:14.023447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '404225b8-c37c-422d-be74-0fc53d01ebc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc185ede700>]}
[0m11:52:14.024233 [info ] [MainThread]: Found 3 models, 2 tests, 2 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:52:14.024912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '404225b8-c37c-422d-be74-0fc53d01ebc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc185ede7f0>]}
[0m11:52:14.026764 [info ] [MainThread]: 
[0m11:52:14.027861 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:52:14.029436 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery_dbt_football'
[0m11:52:14.030150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:14.845762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '404225b8-c37c-422d-be74-0fc53d01ebc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc185ef3580>]}
[0m11:52:14.848473 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:52:14.850397 [info ] [MainThread]: 
[0m11:52:14.856160 [debug] [Thread-1  ]: Began running node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:52:14.858954 [debug] [Thread-2  ]: Began running node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:52:14.857824 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_football_matches_team1 .......................... [RUN]
[0m11:52:14.860610 [info ] [Thread-2  ]: 2 of 2 START test not_null_stg_football_matches_team2 .......................... [RUN]
[0m11:52:14.863033 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53)
[0m11:52:14.865454 [debug] [Thread-2  ]: Acquiring new bigquery connection 'test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae'
[0m11:52:14.866367 [debug] [Thread-1  ]: Began compiling node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:52:14.867796 [debug] [Thread-2  ]: Began compiling node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:52:14.904785 [debug] [Thread-2  ]: Writing injected SQL for node "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"
[0m11:52:14.912591 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae (compile): 11:52:14.884190 => 11:52:14.911437
[0m11:52:14.916438 [debug] [Thread-1  ]: Writing injected SQL for node "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"
[0m11:52:14.917363 [debug] [Thread-2  ]: Began executing node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:52:14.928774 [debug] [Thread-1  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53 (compile): 11:52:14.868745 => 11:52:14.928148
[0m11:52:14.934693 [debug] [Thread-1  ]: Began executing node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:52:14.953336 [debug] [Thread-2  ]: Writing runtime sql for node "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"
[0m11:52:14.955117 [debug] [Thread-1  ]: Writing runtime sql for node "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"
[0m11:52:14.955951 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:52:14.956779 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:52:14.998945 [debug] [Thread-2  ]: On test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team2
from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
where team2 is null



      
    ) dbt_internal_test
[0m11:52:15.000642 [debug] [Thread-1  ]: On test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team1
from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
where team1 is null



      
    ) dbt_internal_test
[0m11:52:16.254632 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:c5c834c2-f3c6-47fc-86ce-d703af183318&page=queryresults
[0m11:52:16.297066 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:d9450589-aa42-4656-9595-cc0b6de8d3de&page=queryresults
[0m11:52:17.179617 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae (execute): 11:52:14.917900 => 11:52:17.178633
[0m11:52:17.181306 [info ] [Thread-2  ]: 2 of 2 PASS not_null_stg_football_matches_team2 ................................ [[32mPASS[0m in 2.32s]
[0m11:52:17.182949 [debug] [Thread-2  ]: Finished running node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:52:17.184475 [debug] [Thread-1  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53 (execute): 11:52:14.935108 => 11:52:17.184087
[0m11:52:17.185671 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_football_matches_team1 ................................ [[32mPASS[0m in 2.32s]
[0m11:52:17.186737 [debug] [Thread-1  ]: Finished running node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:52:17.190385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:17.191871 [debug] [MainThread]: Connection 'test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53' was properly closed.
[0m11:52:17.193004 [debug] [MainThread]: Connection 'test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae' was properly closed.
[0m11:52:17.194187 [info ] [MainThread]: 
[0m11:52:17.195418 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m11:52:17.197957 [debug] [MainThread]: Command end result
[0m11:52:17.220778 [info ] [MainThread]: 
[0m11:52:17.222048 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:52:17.223195 [info ] [MainThread]: 
[0m11:52:17.224314 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:52:17.225583 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.348235, "process_user_time": 5.640815, "process_kernel_time": 0.432983, "process_mem_max_rss": "194224", "process_out_blocks": "2768", "process_in_blocks": "0"}
[0m11:52:17.227041 [debug] [MainThread]: Command `dbt test` succeeded at 11:52:17.226647 after 5.35 seconds
[0m11:52:17.228129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1998f9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc185f41910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1867bbd90>]}
[0m11:52:17.229298 [debug] [MainThread]: Flushing usage events
[0m11:52:30.391491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f312a69ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3128995190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3128991400>]}


============================== 11:52:30.394649 | cb0ae434-b494-4967-8589-d77675780e14 ==============================
[0m11:52:30.394649 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:52:30.395477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m11:52:31.603375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb0ae434-b494-4967-8589-d77675780e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3117c49ca0>]}
[0m11:52:31.787123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb0ae434-b494-4967-8589-d77675780e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3117509dc0>]}
[0m11:52:31.788090 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m11:52:31.798789 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:52:31.852192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:52:31.853104 [debug] [MainThread]: Partial parsing: updated file: estudos_dbt://models/football/staging/schema.yml
[0m11:52:32.442621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb0ae434-b494-4967-8589-d77675780e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31170f91f0>]}
[0m11:52:32.456430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb0ae434-b494-4967-8589-d77675780e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3117916ca0>]}
[0m11:52:32.457101 [info ] [MainThread]: Found 3 models, 3 tests, 2 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:52:32.457673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb0ae434-b494-4967-8589-d77675780e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3117130ee0>]}
[0m11:52:32.459381 [info ] [MainThread]: 
[0m11:52:32.460432 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:52:32.462111 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery_dbt_football'
[0m11:52:32.463145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:33.184171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb0ae434-b494-4967-8589-d77675780e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3116d7f040>]}
[0m11:52:33.187072 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:52:33.188899 [info ] [MainThread]: 
[0m11:52:33.197974 [debug] [Thread-1  ]: Began running node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:52:33.200089 [debug] [Thread-2  ]: Began running node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:52:33.202763 [debug] [Thread-3  ]: Began running node test.estudos_dbt.unique_stg_football_matches_team1.5bcf5cb6fa
[0m11:52:33.209702 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_football_matches_team2 .......................... [RUN]
[0m11:52:33.206492 [info ] [Thread-1  ]: 1 of 3 START test not_null_stg_football_matches_team1 .......................... [RUN]
[0m11:52:33.218938 [debug] [Thread-2  ]: Acquiring new bigquery connection 'test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae'
[0m11:52:33.228454 [debug] [Thread-2  ]: Began compiling node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:52:33.212544 [info ] [Thread-3  ]: 3 of 3 START test unique_stg_football_matches_team1 ............................ [RUN]
[0m11:52:33.224892 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53)
[0m11:52:33.245255 [debug] [Thread-3  ]: Acquiring new bigquery connection 'test.estudos_dbt.unique_stg_football_matches_team1.5bcf5cb6fa'
[0m11:52:33.254727 [debug] [Thread-1  ]: Began compiling node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:52:33.271087 [debug] [Thread-3  ]: Began compiling node test.estudos_dbt.unique_stg_football_matches_team1.5bcf5cb6fa
[0m11:52:33.279102 [debug] [Thread-2  ]: Writing injected SQL for node "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"
[0m11:52:33.299752 [debug] [Thread-3  ]: Writing injected SQL for node "test.estudos_dbt.unique_stg_football_matches_team1.5bcf5cb6fa"
[0m11:52:33.305852 [debug] [Thread-1  ]: Writing injected SQL for node "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"
[0m11:52:33.308670 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae (compile): 11:52:33.230335 => 11:52:33.307908
[0m11:52:33.311223 [debug] [Thread-3  ]: Timing info for test.estudos_dbt.unique_stg_football_matches_team1.5bcf5cb6fa (compile): 11:52:33.282038 => 11:52:33.310214
[0m11:52:33.312533 [debug] [Thread-2  ]: Began executing node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:52:33.313801 [debug] [Thread-3  ]: Began executing node test.estudos_dbt.unique_stg_football_matches_team1.5bcf5cb6fa
[0m11:52:33.315015 [debug] [Thread-1  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53 (compile): 11:52:33.280011 => 11:52:33.314318
[0m11:52:33.352298 [debug] [Thread-1  ]: Began executing node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:52:33.367049 [debug] [Thread-3  ]: Writing runtime sql for node "test.estudos_dbt.unique_stg_football_matches_team1.5bcf5cb6fa"
[0m11:52:33.369491 [debug] [Thread-1  ]: Writing runtime sql for node "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"
[0m11:52:33.371110 [debug] [Thread-2  ]: Writing runtime sql for node "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"
[0m11:52:33.373059 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:52:33.374517 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:52:33.376362 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:52:33.418695 [debug] [Thread-1  ]: On test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team1
from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
where team1 is null



      
    ) dbt_internal_test
[0m11:52:33.459057 [debug] [Thread-3  ]: On test.estudos_dbt.unique_stg_football_matches_team1.5bcf5cb6fa: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.unique_stg_football_matches_team1.5bcf5cb6fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select team1 as unique_field
  from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
  where team1 is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:52:33.460767 [debug] [Thread-2  ]: On test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team2
from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
where team2 is null



      
    ) dbt_internal_test
[0m11:52:34.687170 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:bc7f561a-bbef-450f-a956-2fc0ce20c167&page=queryresults
[0m11:52:34.691839 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:1733f005-505c-41d4-8f41-05ef7e9715c2&page=queryresults
[0m11:52:34.821810 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:5bf245d2-5aae-4bc7-aa29-fd623b7b6b7a&page=queryresults
[0m11:52:35.715173 [debug] [Thread-3  ]: Timing info for test.estudos_dbt.unique_stg_football_matches_team1.5bcf5cb6fa (execute): 11:52:33.326349 => 11:52:35.714576
[0m11:52:35.717026 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae (execute): 11:52:33.315905 => 11:52:35.716459
[0m11:52:35.718547 [error] [Thread-3  ]: 3 of 3 FAIL 662 unique_stg_football_matches_team1 .............................. [[31mFAIL 662[0m in 2.47s]
[0m11:52:35.719853 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_football_matches_team2 ................................ [[32mPASS[0m in 2.50s]
[0m11:52:35.720849 [debug] [Thread-3  ]: Finished running node test.estudos_dbt.unique_stg_football_matches_team1.5bcf5cb6fa
[0m11:52:35.721978 [debug] [Thread-2  ]: Finished running node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:52:35.767134 [debug] [Thread-1  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53 (execute): 11:52:33.358153 => 11:52:35.766036
[0m11:52:35.770295 [info ] [Thread-1  ]: 1 of 3 PASS not_null_stg_football_matches_team1 ................................ [[32mPASS[0m in 2.55s]
[0m11:52:35.774815 [debug] [Thread-1  ]: Finished running node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:52:35.780668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:35.782050 [debug] [MainThread]: Connection 'test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53' was properly closed.
[0m11:52:35.783123 [debug] [MainThread]: Connection 'test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae' was properly closed.
[0m11:52:35.784177 [debug] [MainThread]: Connection 'test.estudos_dbt.unique_stg_football_matches_team1.5bcf5cb6fa' was properly closed.
[0m11:52:35.785278 [info ] [MainThread]: 
[0m11:52:35.786383 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m11:52:35.789507 [debug] [MainThread]: Command end result
[0m11:52:35.815448 [info ] [MainThread]: 
[0m11:52:35.816321 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:52:35.816994 [info ] [MainThread]: 
[0m11:52:35.817781 [error] [MainThread]: [31mFailure in test unique_stg_football_matches_team1 (models/football/staging/schema.yml)[0m
[0m11:52:35.818640 [error] [MainThread]:   Got 662 results, configured to fail if != 0
[0m11:52:35.819463 [info ] [MainThread]: 
[0m11:52:35.820332 [info ] [MainThread]:   compiled Code at target/compiled/estudos_dbt/models/football/staging/schema.yml/unique_stg_football_matches_team1.sql
[0m11:52:35.821711 [info ] [MainThread]: 
[0m11:52:35.824513 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:52:35.826969 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.518928, "process_user_time": 6.278768, "process_kernel_time": 0.572617, "process_mem_max_rss": "195484", "process_out_blocks": "2816", "command_success": false, "process_in_blocks": "0"}
[0m11:52:35.829057 [debug] [MainThread]: Command `dbt test` failed at 11:52:35.828494 after 5.52 seconds
[0m11:52:35.830752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f312a69ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31178f0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31170f9040>]}
[0m11:52:35.831741 [debug] [MainThread]: Flushing usage events
[0m11:52:48.777437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff3b61ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff3992aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff3991cf10>]}


============================== 11:52:48.788938 | 0cbf667b-b2e8-4fe9-a526-575672415d8b ==============================
[0m11:52:48.788938 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:52:48.794044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:52:50.205816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cbf667b-b2e8-4fe9-a526-575672415d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff2898f340>]}
[0m11:52:50.388114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cbf667b-b2e8-4fe9-a526-575672415d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff28490b80>]}
[0m11:52:50.389043 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m11:52:50.402613 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:52:50.447137 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:52:50.448017 [debug] [MainThread]: Partial parsing: updated file: estudos_dbt://models/football/staging/schema.yml
[0m11:52:51.096381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cbf667b-b2e8-4fe9-a526-575672415d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff279cd8e0>]}
[0m11:52:51.113216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cbf667b-b2e8-4fe9-a526-575672415d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff279cd8e0>]}
[0m11:52:51.113865 [info ] [MainThread]: Found 3 models, 2 tests, 2 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:52:51.114533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cbf667b-b2e8-4fe9-a526-575672415d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff280b1ee0>]}
[0m11:52:51.117001 [info ] [MainThread]: 
[0m11:52:51.118373 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:52:51.120733 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery_dbt_football'
[0m11:52:51.121615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:51.897215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cbf667b-b2e8-4fe9-a526-575672415d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff27d3da00>]}
[0m11:52:51.902234 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:52:51.904988 [info ] [MainThread]: 
[0m11:52:51.914527 [debug] [Thread-1  ]: Began running node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:52:51.917346 [debug] [Thread-2  ]: Began running node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:52:51.919809 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_football_matches_team1 .......................... [RUN]
[0m11:52:51.922080 [info ] [Thread-2  ]: 2 of 2 START test not_null_stg_football_matches_team2 .......................... [RUN]
[0m11:52:51.924343 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53)
[0m11:52:51.928348 [debug] [Thread-2  ]: Acquiring new bigquery connection 'test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae'
[0m11:52:51.930731 [debug] [Thread-1  ]: Began compiling node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:52:51.932918 [debug] [Thread-2  ]: Began compiling node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:52:51.969613 [debug] [Thread-2  ]: Writing injected SQL for node "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"
[0m11:52:51.981757 [debug] [Thread-1  ]: Writing injected SQL for node "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"
[0m11:52:51.983331 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae (compile): 11:52:51.939704 => 11:52:51.982658
[0m11:52:51.984960 [debug] [Thread-2  ]: Began executing node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:52:51.986062 [debug] [Thread-1  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53 (compile): 11:52:51.933969 => 11:52:51.985411
[0m11:52:51.998394 [debug] [Thread-1  ]: Began executing node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:52:52.031300 [debug] [Thread-1  ]: Writing runtime sql for node "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"
[0m11:52:52.029499 [debug] [Thread-2  ]: Writing runtime sql for node "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"
[0m11:52:52.032276 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:52:52.033100 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:52:52.075333 [debug] [Thread-1  ]: On test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team1
from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
where team1 is null



      
    ) dbt_internal_test
[0m11:52:52.076995 [debug] [Thread-2  ]: On test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team2
from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
where team2 is null



      
    ) dbt_internal_test
[0m11:52:53.330903 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:f477e940-a17a-4114-8b20-2a901c441605&page=queryresults
[0m11:52:53.345033 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:4280b09a-60f9-4a9d-9cf4-68dba295c2f6&page=queryresults
[0m11:52:54.313253 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae (execute): 11:52:51.987684 => 11:52:54.312043
[0m11:52:54.318903 [info ] [Thread-2  ]: 2 of 2 PASS not_null_stg_football_matches_team2 ................................ [[32mPASS[0m in 2.39s]
[0m11:52:54.322715 [debug] [Thread-2  ]: Finished running node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:52:54.328921 [debug] [Thread-1  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53 (execute): 11:52:52.009492 => 11:52:54.326730
[0m11:52:54.335991 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_football_matches_team1 ................................ [[32mPASS[0m in 2.41s]
[0m11:52:54.341878 [debug] [Thread-1  ]: Finished running node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:52:54.354497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:54.360594 [debug] [MainThread]: Connection 'test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53' was properly closed.
[0m11:52:54.366948 [debug] [MainThread]: Connection 'test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae' was properly closed.
[0m11:52:54.370006 [info ] [MainThread]: 
[0m11:52:54.376062 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m11:52:54.389384 [debug] [MainThread]: Command end result
[0m11:52:54.428219 [info ] [MainThread]: 
[0m11:52:54.434148 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:52:54.438773 [info ] [MainThread]: 
[0m11:52:54.441903 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:52:54.446011 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.763541, "process_user_time": 6.896719, "process_kernel_time": 0.548693, "process_mem_max_rss": "193848", "process_out_blocks": "2760", "process_in_blocks": "0"}
[0m11:52:54.447780 [debug] [MainThread]: Command `dbt test` succeeded at 11:52:54.447232 after 5.77 seconds
[0m11:52:54.449506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff3b61ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff27cd96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff28490b80>]}
[0m11:52:54.458713 [debug] [MainThread]: Flushing usage events
[0m11:59:03.615097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7468e1ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7467128a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7467119ee0>]}


============================== 11:59:03.618250 | 596864d6-5aad-4810-a5a0-dc9f32e11605 ==============================
[0m11:59:03.618250 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:59:03.619097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'debug': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:59:04.805306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '596864d6-5aad-4810-a5a0-dc9f32e11605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74561a2880>]}
[0m11:59:04.997791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '596864d6-5aad-4810-a5a0-dc9f32e11605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7455c89760>]}
[0m11:59:04.999311 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m11:59:05.012322 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:59:05.085551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:59:05.087066 [debug] [MainThread]: Partial parsing: added file: estudos_dbt://tests/assert_valid_season.sql
[0m11:59:05.290589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '596864d6-5aad-4810-a5a0-dc9f32e11605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74554e5400>]}
[0m11:59:05.306257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '596864d6-5aad-4810-a5a0-dc9f32e11605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745586a790>]}
[0m11:59:05.306956 [info ] [MainThread]: Found 3 models, 3 tests, 2 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:59:05.307634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '596864d6-5aad-4810-a5a0-dc9f32e11605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7455c89b50>]}
[0m11:59:05.310244 [info ] [MainThread]: 
[0m11:59:05.311887 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:59:05.316453 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery_dbt_football'
[0m11:59:05.317129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:06.171317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '596864d6-5aad-4810-a5a0-dc9f32e11605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74555c8280>]}
[0m11:59:06.172374 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:59:06.173035 [info ] [MainThread]: 
[0m11:59:06.175903 [debug] [Thread-1  ]: Began running node test.estudos_dbt.assert_valid_season
[0m11:59:06.177138 [debug] [Thread-2  ]: Began running node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:59:06.176550 [info ] [Thread-1  ]: 1 of 3 START test assert_valid_season .......................................... [RUN]
[0m11:59:06.178110 [debug] [Thread-3  ]: Began running node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:59:06.179138 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_football_matches_team1 .......................... [RUN]
[0m11:59:06.180398 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now test.estudos_dbt.assert_valid_season)
[0m11:59:06.182972 [debug] [Thread-2  ]: Acquiring new bigquery connection 'test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53'
[0m11:59:06.181590 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_football_matches_team2 .......................... [RUN]
[0m11:59:06.183782 [debug] [Thread-1  ]: Began compiling node test.estudos_dbt.assert_valid_season
[0m11:59:06.184576 [debug] [Thread-2  ]: Began compiling node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:59:06.186795 [debug] [Thread-3  ]: Acquiring new bigquery connection 'test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae'
[0m11:59:06.205657 [debug] [Thread-1  ]: Writing injected SQL for node "test.estudos_dbt.assert_valid_season"
[0m11:59:06.218868 [debug] [Thread-3  ]: Began compiling node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:59:06.225014 [debug] [Thread-2  ]: Writing injected SQL for node "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"
[0m11:59:06.231801 [debug] [Thread-1  ]: Timing info for test.estudos_dbt.assert_valid_season (compile): 11:59:06.187666 => 11:59:06.231111
[0m11:59:06.236847 [debug] [Thread-3  ]: Writing injected SQL for node "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"
[0m11:59:06.237761 [debug] [Thread-1  ]: Began executing node test.estudos_dbt.assert_valid_season
[0m11:59:06.241094 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53 (compile): 11:59:06.198011 => 11:59:06.240700
[0m11:59:06.245216 [debug] [Thread-2  ]: Began executing node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:59:06.261850 [debug] [Thread-3  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae (compile): 11:59:06.225765 => 11:59:06.261429
[0m11:59:06.267698 [debug] [Thread-3  ]: Began executing node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:59:06.290318 [debug] [Thread-1  ]: Writing runtime sql for node "test.estudos_dbt.assert_valid_season"
[0m11:59:06.290888 [debug] [Thread-3  ]: Writing runtime sql for node "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"
[0m11:59:06.295926 [debug] [Thread-2  ]: Writing runtime sql for node "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"
[0m11:59:06.297080 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:59:06.297781 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:59:06.298570 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:59:06.340638 [debug] [Thread-2  ]: On test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team1
from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
where team1 is null



      
    ) dbt_internal_test
[0m11:59:06.379032 [debug] [Thread-1  ]: On test.estudos_dbt.assert_valid_season: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.assert_valid_season"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with matches as (
    select * from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
)

select *
from matches
where season not in ('2019','2021','2022')
      
    ) dbt_internal_test
[0m11:59:06.381072 [debug] [Thread-3  ]: On test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team2
from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
where team2 is null



      
    ) dbt_internal_test
[0m11:59:07.502054 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:83f2dc68-206e-4b9b-8079-bf7f3f0d950f&page=queryresults
[0m11:59:07.503102 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:6fa14401-ea46-4018-991d-2b0a7175b1bc&page=queryresults
[0m11:59:07.506956 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator IN for argument types INT64 and {STRING} at [13:18]')
[0m11:59:07.511516 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:7acc3ee9-f5a2-4296-a6d6-c2b5d38a8f61&page=queryresults
[0m11:59:08.526846 [debug] [Thread-3  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae (execute): 11:59:06.273277 => 11:59:08.526238
[0m11:59:08.528622 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53 (execute): 11:59:06.246032 => 11:59:08.528079
[0m11:59:08.530277 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_football_matches_team2 ................................ [[32mPASS[0m in 2.34s]
[0m11:59:08.532057 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_football_matches_team1 ................................ [[32mPASS[0m in 2.35s]
[0m11:59:08.533611 [debug] [Thread-3  ]: Finished running node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:59:08.534680 [debug] [Thread-2  ]: Finished running node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:59:08.561904 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:90547330-a6db-4826-8fd2-6e5975e83d88&page=queryresults
[0m11:59:08.565520 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:90547330-a6db-4826-8fd2-6e5975e83d88&page=queryresults
[0m11:59:08.567630 [debug] [Thread-1  ]: Timing info for test.estudos_dbt.assert_valid_season (execute): 11:59:06.238596 => 11:59:08.566908
[0m11:59:08.577709 [debug] [Thread-1  ]: Database Error in test assert_valid_season (tests/assert_valid_season.sql)
  No matching signature for operator IN for argument types INT64 and {STRING} at [13:18]
  compiled Code at target/run/estudos_dbt/tests/assert_valid_season.sql
[0m11:59:08.579336 [error] [Thread-1  ]: 1 of 3 ERROR assert_valid_season ............................................... [[31mERROR[0m in 2.40s]
[0m11:59:08.581923 [debug] [Thread-1  ]: Finished running node test.estudos_dbt.assert_valid_season
[0m11:59:08.585348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:08.586662 [debug] [MainThread]: Connection 'test.estudos_dbt.assert_valid_season' was properly closed.
[0m11:59:08.587324 [debug] [MainThread]: Connection 'test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53' was properly closed.
[0m11:59:08.588188 [debug] [MainThread]: Connection 'test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae' was properly closed.
[0m11:59:08.589045 [info ] [MainThread]: 
[0m11:59:08.589846 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 3.28 seconds (3.28s).
[0m11:59:08.591786 [debug] [MainThread]: Command end result
[0m11:59:08.612546 [info ] [MainThread]: 
[0m11:59:08.614519 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:59:08.615644 [info ] [MainThread]: 
[0m11:59:08.617026 [error] [MainThread]:   Database Error in test assert_valid_season (tests/assert_valid_season.sql)
  No matching signature for operator IN for argument types INT64 and {STRING} at [13:18]
  compiled Code at target/run/estudos_dbt/tests/assert_valid_season.sql
[0m11:59:08.618017 [info ] [MainThread]: 
[0m11:59:08.618840 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:59:08.620050 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.0931478, "process_user_time": 5.625576, "process_kernel_time": 0.464853, "process_mem_max_rss": "193124", "process_in_blocks": "16", "process_out_blocks": "2808", "command_success": false}
[0m11:59:08.621403 [debug] [MainThread]: Command `dbt test` failed at 11:59:08.621074 after 5.09 seconds
[0m11:59:08.622278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7468e1ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745608e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74554d0ee0>]}
[0m11:59:08.622919 [debug] [MainThread]: Flushing usage events
[0m11:59:30.673148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7064e39af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7063108640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7063108df0>]}


============================== 11:59:30.676339 | 83173638-a66a-431a-8438-2ead91451fa2 ==============================
[0m11:59:30.676339 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:59:30.677123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:59:31.871229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83173638-a66a-431a-8438-2ead91451fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70520f2940>]}
[0m11:59:32.065918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83173638-a66a-431a-8438-2ead91451fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7051cbacd0>]}
[0m11:59:32.067117 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m11:59:32.078551 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:59:32.130259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:59:32.131066 [debug] [MainThread]: Partial parsing: updated file: estudos_dbt://tests/assert_valid_season.sql
[0m11:59:32.329068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83173638-a66a-431a-8438-2ead91451fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70514a7580>]}
[0m11:59:32.348732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83173638-a66a-431a-8438-2ead91451fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70514ef1c0>]}
[0m11:59:32.349405 [info ] [MainThread]: Found 3 models, 3 tests, 2 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:59:32.350148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83173638-a66a-431a-8438-2ead91451fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7051492d30>]}
[0m11:59:32.351870 [info ] [MainThread]: 
[0m11:59:32.352894 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:59:32.354624 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery_dbt_football'
[0m11:59:32.355165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:33.206855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83173638-a66a-431a-8438-2ead91451fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70515ee820>]}
[0m11:59:33.208538 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:59:33.209194 [info ] [MainThread]: 
[0m11:59:33.212015 [debug] [Thread-1  ]: Began running node test.estudos_dbt.assert_valid_season
[0m11:59:33.212776 [debug] [Thread-2  ]: Began running node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:59:33.214134 [debug] [Thread-3  ]: Began running node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:59:33.213379 [info ] [Thread-1  ]: 1 of 3 START test assert_valid_season .......................................... [RUN]
[0m11:59:33.215778 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_football_matches_team1 .......................... [RUN]
[0m11:59:33.217053 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_football_matches_team2 .......................... [RUN]
[0m11:59:33.218740 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now test.estudos_dbt.assert_valid_season)
[0m11:59:33.221371 [debug] [Thread-2  ]: Acquiring new bigquery connection 'test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53'
[0m11:59:33.223278 [debug] [Thread-3  ]: Acquiring new bigquery connection 'test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae'
[0m11:59:33.225040 [debug] [Thread-1  ]: Began compiling node test.estudos_dbt.assert_valid_season
[0m11:59:33.226192 [debug] [Thread-2  ]: Began compiling node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:59:33.228145 [debug] [Thread-3  ]: Began compiling node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:59:33.238659 [debug] [Thread-1  ]: Writing injected SQL for node "test.estudos_dbt.assert_valid_season"
[0m11:59:33.282707 [debug] [Thread-3  ]: Writing injected SQL for node "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"
[0m11:59:33.281548 [debug] [Thread-2  ]: Writing injected SQL for node "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"
[0m11:59:33.284308 [debug] [Thread-1  ]: Timing info for test.estudos_dbt.assert_valid_season (compile): 11:59:33.229025 => 11:59:33.283792
[0m11:59:33.285424 [debug] [Thread-1  ]: Began executing node test.estudos_dbt.assert_valid_season
[0m11:59:33.286115 [debug] [Thread-3  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae (compile): 11:59:33.249591 => 11:59:33.285805
[0m11:59:33.291169 [debug] [Thread-3  ]: Began executing node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:59:33.303050 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53 (compile): 11:59:33.239245 => 11:59:33.302659
[0m11:59:33.308958 [debug] [Thread-2  ]: Began executing node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:59:33.343286 [debug] [Thread-1  ]: Writing runtime sql for node "test.estudos_dbt.assert_valid_season"
[0m11:59:33.350546 [debug] [Thread-2  ]: Writing runtime sql for node "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"
[0m11:59:33.352168 [debug] [Thread-3  ]: Writing runtime sql for node "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"
[0m11:59:33.353442 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:59:33.354337 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:59:33.355062 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:59:33.399260 [debug] [Thread-2  ]: On test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team1
from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
where team1 is null



      
    ) dbt_internal_test
[0m11:59:33.435545 [debug] [Thread-1  ]: On test.estudos_dbt.assert_valid_season: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.assert_valid_season"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with matches as (
    select * from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
)

select *
from matches
where season not in (2019,2021,2022)
      
    ) dbt_internal_test
[0m11:59:33.437475 [debug] [Thread-3  ]: On test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team2
from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
where team2 is null



      
    ) dbt_internal_test
[0m11:59:34.328407 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:016ee241-63e1-40eb-9fc7-c1984138c0a2&page=queryresults
[0m11:59:34.410090 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:038d0213-6ca9-44f7-8d70-0403e18c02e2&page=queryresults
[0m11:59:34.667320 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:72a73d36-d803-47c6-a136-3be58da7c8cd&page=queryresults
[0m11:59:35.259851 [debug] [Thread-3  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae (execute): 11:59:33.292212 => 11:59:35.259458
[0m11:59:35.262744 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53 (execute): 11:59:33.314753 => 11:59:35.262359
[0m11:59:35.261388 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_football_matches_team2 ................................ [[32mPASS[0m in 2.04s]
[0m11:59:35.265033 [debug] [Thread-3  ]: Finished running node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:59:35.264028 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_football_matches_team1 ................................ [[32mPASS[0m in 2.04s]
[0m11:59:35.266542 [debug] [Thread-2  ]: Finished running node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:59:35.660123 [debug] [Thread-1  ]: Timing info for test.estudos_dbt.assert_valid_season (execute): 11:59:33.286556 => 11:59:35.658962
[0m11:59:35.663601 [info ] [Thread-1  ]: 1 of 3 PASS assert_valid_season ................................................ [[32mPASS[0m in 2.44s]
[0m11:59:35.666640 [debug] [Thread-1  ]: Finished running node test.estudos_dbt.assert_valid_season
[0m11:59:35.673849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:35.675691 [debug] [MainThread]: Connection 'test.estudos_dbt.assert_valid_season' was properly closed.
[0m11:59:35.677439 [debug] [MainThread]: Connection 'test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53' was properly closed.
[0m11:59:35.678777 [debug] [MainThread]: Connection 'test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae' was properly closed.
[0m11:59:35.679401 [info ] [MainThread]: 
[0m11:59:35.680087 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m11:59:35.681458 [debug] [MainThread]: Command end result
[0m11:59:35.700087 [info ] [MainThread]: 
[0m11:59:35.701255 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:59:35.702255 [info ] [MainThread]: 
[0m11:59:35.703329 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:59:35.704199 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.1144238, "process_user_time": 5.566328, "process_kernel_time": 0.547835, "process_mem_max_rss": "191672", "process_out_blocks": "2792", "process_in_blocks": "0"}
[0m11:59:35.705072 [debug] [MainThread]: Command `dbt test` succeeded at 11:59:35.704834 after 5.12 seconds
[0m11:59:35.705921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7064e39af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7051d9e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70514fdb80>]}
[0m11:59:35.708543 [debug] [MainThread]: Flushing usage events
[0m11:59:54.535497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6879a1c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6877ce5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6877cdcf70>]}


============================== 11:59:54.538564 | e02606ec-7dcc-418f-8d19-52df9bab12fe ==============================
[0m11:59:54.538564 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:59:54.539304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:59:55.681618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e02606ec-7dcc-418f-8d19-52df9bab12fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6866d79610>]}
[0m11:59:55.861616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e02606ec-7dcc-418f-8d19-52df9bab12fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68668b90a0>]}
[0m11:59:55.862576 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m11:59:55.875994 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:59:55.927128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:59:55.927980 [debug] [MainThread]: Partial parsing: updated file: estudos_dbt://tests/assert_valid_season.sql
[0m11:59:56.112201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e02606ec-7dcc-418f-8d19-52df9bab12fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68660a9550>]}
[0m11:59:56.126465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e02606ec-7dcc-418f-8d19-52df9bab12fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68660f0070>]}
[0m11:59:56.127119 [info ] [MainThread]: Found 3 models, 3 tests, 2 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:59:56.127683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e02606ec-7dcc-418f-8d19-52df9bab12fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6866092d00>]}
[0m11:59:56.129374 [info ] [MainThread]: 
[0m11:59:56.130531 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:59:56.132352 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery_dbt_football'
[0m11:59:56.133454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:56.887246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e02606ec-7dcc-418f-8d19-52df9bab12fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68661ee910>]}
[0m11:59:56.891292 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:59:56.893285 [info ] [MainThread]: 
[0m11:59:56.902861 [debug] [Thread-1  ]: Began running node test.estudos_dbt.assert_valid_season
[0m11:59:56.905221 [debug] [Thread-2  ]: Began running node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:59:56.908825 [debug] [Thread-3  ]: Began running node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:59:56.907089 [info ] [Thread-1  ]: 1 of 3 START test assert_valid_season .......................................... [RUN]
[0m11:59:56.910959 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_football_matches_team1 .......................... [RUN]
[0m11:59:56.913149 [info ] [Thread-3  ]: 3 of 3 START test not_null_stg_football_matches_team2 .......................... [RUN]
[0m11:59:56.916047 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now test.estudos_dbt.assert_valid_season)
[0m11:59:56.917951 [debug] [Thread-2  ]: Acquiring new bigquery connection 'test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53'
[0m11:59:56.919381 [debug] [Thread-3  ]: Acquiring new bigquery connection 'test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae'
[0m11:59:56.922612 [debug] [Thread-1  ]: Began compiling node test.estudos_dbt.assert_valid_season
[0m11:59:56.924117 [debug] [Thread-2  ]: Began compiling node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:59:56.926116 [debug] [Thread-3  ]: Began compiling node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:59:56.936915 [debug] [Thread-1  ]: Writing injected SQL for node "test.estudos_dbt.assert_valid_season"
[0m11:59:56.965322 [debug] [Thread-2  ]: Writing injected SQL for node "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"
[0m11:59:56.966845 [debug] [Thread-3  ]: Writing injected SQL for node "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"
[0m11:59:56.968289 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53 (compile): 11:59:56.937787 => 11:59:56.967708
[0m11:59:56.969313 [debug] [Thread-2  ]: Began executing node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:59:56.972002 [debug] [Thread-1  ]: Timing info for test.estudos_dbt.assert_valid_season (compile): 11:59:56.927252 => 11:59:56.970208
[0m11:59:56.973516 [debug] [Thread-3  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae (compile): 11:59:56.958245 => 11:59:56.972780
[0m11:59:56.979784 [debug] [Thread-1  ]: Began executing node test.estudos_dbt.assert_valid_season
[0m11:59:56.995395 [debug] [Thread-3  ]: Began executing node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:59:57.032083 [debug] [Thread-1  ]: Writing runtime sql for node "test.estudos_dbt.assert_valid_season"
[0m11:59:57.031581 [debug] [Thread-3  ]: Writing runtime sql for node "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"
[0m11:59:57.034295 [debug] [Thread-2  ]: Writing runtime sql for node "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"
[0m11:59:57.035234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:59:57.036354 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:59:57.037472 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:59:57.079504 [debug] [Thread-1  ]: On test.estudos_dbt.assert_valid_season: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.assert_valid_season"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with matches as (
    select * from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
)

select *
from matches
where season not in (
    -- 2019,
    2021,
    2022)
      
    ) dbt_internal_test
[0m11:59:57.118194 [debug] [Thread-2  ]: On test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team1
from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
where team1 is null



      
    ) dbt_internal_test
[0m11:59:57.120300 [debug] [Thread-3  ]: On test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team2
from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
where team2 is null



      
    ) dbt_internal_test
[0m11:59:58.191244 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:54e2167d-f0eb-4944-98eb-9719d93c6e0b&page=queryresults
[0m11:59:58.194978 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:bbdcc3d6-3105-4b03-8402-f1cb213f02b3&page=queryresults
[0m11:59:58.196407 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:01d9fb6f-2b2f-4b4c-981c-caf1c1c53ef6&page=queryresults
[0m11:59:59.080463 [debug] [Thread-1  ]: Timing info for test.estudos_dbt.assert_valid_season (execute): 11:59:56.995865 => 11:59:59.079941
[0m11:59:59.082308 [error] [Thread-1  ]: 1 of 3 FAIL 240 assert_valid_season ............................................ [[31mFAIL 240[0m in 2.17s]
[0m11:59:59.083994 [debug] [Thread-1  ]: Finished running node test.estudos_dbt.assert_valid_season
[0m11:59:59.086197 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53 (execute): 11:59:56.974512 => 11:59:59.085628
[0m11:59:59.088215 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_football_matches_team1 ................................ [[32mPASS[0m in 2.17s]
[0m11:59:59.090627 [debug] [Thread-2  ]: Finished running node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m11:59:59.126646 [debug] [Thread-3  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae (execute): 11:59:57.006197 => 11:59:59.125692
[0m11:59:59.128372 [info ] [Thread-3  ]: 3 of 3 PASS not_null_stg_football_matches_team2 ................................ [[32mPASS[0m in 2.21s]
[0m11:59:59.129788 [debug] [Thread-3  ]: Finished running node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m11:59:59.132028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:59.132542 [debug] [MainThread]: Connection 'test.estudos_dbt.assert_valid_season' was properly closed.
[0m11:59:59.132977 [debug] [MainThread]: Connection 'test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53' was properly closed.
[0m11:59:59.133398 [debug] [MainThread]: Connection 'test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae' was properly closed.
[0m11:59:59.133871 [info ] [MainThread]: 
[0m11:59:59.134930 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m11:59:59.137824 [debug] [MainThread]: Command end result
[0m11:59:59.153854 [info ] [MainThread]: 
[0m11:59:59.155748 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:59:59.156733 [info ] [MainThread]: 
[0m11:59:59.158464 [error] [MainThread]: [31mFailure in test assert_valid_season (tests/assert_valid_season.sql)[0m
[0m11:59:59.159236 [error] [MainThread]:   Got 240 results, configured to fail if != 0
[0m11:59:59.160065 [info ] [MainThread]: 
[0m11:59:59.161071 [info ] [MainThread]:   compiled Code at target/compiled/estudos_dbt/tests/assert_valid_season.sql
[0m11:59:59.161866 [info ] [MainThread]: 
[0m11:59:59.162800 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:59:59.165025 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.7220907, "process_user_time": 5.516229, "process_kernel_time": 0.453004, "process_mem_max_rss": "191940", "process_out_blocks": "2808", "command_success": false, "process_in_blocks": "0"}
[0m11:59:59.166463 [debug] [MainThread]: Command `dbt test` failed at 11:59:59.166085 after 4.72 seconds
[0m11:59:59.168076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6879a1c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6866137f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68668b9a60>]}
[0m11:59:59.169089 [debug] [MainThread]: Flushing usage events
[0m12:04:18.399385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea22dc4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea05acaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea05c9f70>]}


============================== 12:04:18.402457 | 404e970d-4919-4259-bc9b-a668fae66797 ==============================
[0m12:04:18.402457 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:04:18.403208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m12:04:19.572749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '404e970d-4919-4259-bc9b-a668fae66797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8f8b8610>]}
[0m12:04:19.767015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '404e970d-4919-4259-bc9b-a668fae66797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8f1b80a0>]}
[0m12:04:19.767956 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m12:04:19.778328 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:04:19.834713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:04:19.835921 [debug] [MainThread]: Partial parsing: updated file: estudos_dbt://models/football/staging/sources.yml
[0m12:04:19.836514 [debug] [MainThread]: Partial parsing: updated file: estudos_dbt://tests/assert_valid_season.sql
[0m12:04:20.712813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '404e970d-4919-4259-bc9b-a668fae66797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8e053340>]}
[0m12:04:20.726488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '404e970d-4919-4259-bc9b-a668fae66797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8f0b96a0>]}
[0m12:04:20.727143 [info ] [MainThread]: Found 3 models, 4 tests, 2 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:04:20.727758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '404e970d-4919-4259-bc9b-a668fae66797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8f5f2af0>]}
[0m12:04:20.729556 [info ] [MainThread]: 
[0m12:04:20.730665 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:04:20.732238 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery_dbt_football'
[0m12:04:20.733129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:21.564240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '404e970d-4919-4259-bc9b-a668fae66797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8e5dfcd0>]}
[0m12:04:21.565459 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:04:21.566388 [info ] [MainThread]: 
[0m12:04:21.570288 [debug] [Thread-1  ]: Began running node test.estudos_dbt.assert_valid_season
[0m12:04:21.570992 [debug] [Thread-2  ]: Began running node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m12:04:21.572073 [debug] [Thread-3  ]: Began running node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m12:04:21.574310 [debug] [Thread-4  ]: Began running node test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6
[0m12:04:21.573230 [info ] [Thread-1  ]: 1 of 4 START test assert_valid_season .......................................... [RUN]
[0m12:04:21.579200 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now test.estudos_dbt.assert_valid_season)
[0m12:04:21.576440 [info ] [Thread-3  ]: 3 of 4 START test not_null_stg_football_matches_team2 .......................... [RUN]
[0m12:04:21.575664 [info ] [Thread-2  ]: 2 of 4 START test not_null_stg_football_matches_team1 .......................... [RUN]
[0m12:04:21.577461 [info ] [Thread-4  ]: 4 of 4 START test source_not_null_spi_spi_matches_latest_league ................ [RUN]
[0m12:04:21.580939 [debug] [Thread-1  ]: Began compiling node test.estudos_dbt.assert_valid_season
[0m12:04:21.583528 [debug] [Thread-3  ]: Acquiring new bigquery connection 'test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae'
[0m12:04:21.585408 [debug] [Thread-2  ]: Acquiring new bigquery connection 'test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53'
[0m12:04:21.586962 [debug] [Thread-4  ]: Acquiring new bigquery connection 'test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6'
[0m12:04:21.598377 [debug] [Thread-3  ]: Began compiling node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m12:04:21.602653 [debug] [Thread-1  ]: Writing injected SQL for node "test.estudos_dbt.assert_valid_season"
[0m12:04:21.603350 [debug] [Thread-2  ]: Began compiling node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m12:04:21.603929 [debug] [Thread-4  ]: Began compiling node test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6
[0m12:04:21.616083 [debug] [Thread-1  ]: Timing info for test.estudos_dbt.assert_valid_season (compile): 12:04:21.587382 => 12:04:21.615590
[0m12:04:21.642601 [debug] [Thread-1  ]: Began executing node test.estudos_dbt.assert_valid_season
[0m12:04:21.651601 [debug] [Thread-2  ]: Writing injected SQL for node "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"
[0m12:04:21.656031 [debug] [Thread-3  ]: Writing injected SQL for node "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"
[0m12:04:21.660593 [debug] [Thread-4  ]: Writing injected SQL for node "test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6"
[0m12:04:21.684416 [debug] [Thread-1  ]: Writing runtime sql for node "test.estudos_dbt.assert_valid_season"
[0m12:04:21.685288 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53 (compile): 12:04:21.610447 => 12:04:21.684911
[0m12:04:21.686370 [debug] [Thread-4  ]: Timing info for test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6 (compile): 12:04:21.626602 => 12:04:21.685963
[0m12:04:21.687092 [debug] [Thread-2  ]: Began executing node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m12:04:21.687996 [debug] [Thread-3  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae (compile): 12:04:21.604322 => 12:04:21.687439
[0m12:04:21.688834 [debug] [Thread-4  ]: Began executing node test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6
[0m12:04:21.693122 [debug] [Thread-2  ]: Writing runtime sql for node "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"
[0m12:04:21.693855 [debug] [Thread-3  ]: Began executing node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m12:04:21.694473 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:04:21.697662 [debug] [Thread-4  ]: Writing runtime sql for node "test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6"
[0m12:04:21.703021 [debug] [Thread-3  ]: Writing runtime sql for node "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"
[0m12:04:21.704444 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:04:21.705715 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:04:21.706809 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:04:21.783165 [debug] [Thread-1  ]: On test.estudos_dbt.assert_valid_season: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.assert_valid_season"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with matches as (
    select * from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
)

select *
from matches
where season not in (
    2019,
    2021,
    2022
)
      
    ) dbt_internal_test
[0m12:04:21.786364 [debug] [Thread-2  ]: On test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team1
from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
where team1 is null



      
    ) dbt_internal_test
[0m12:04:21.788303 [debug] [Thread-4  ]: On test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select league
from `estudos-dbt-e-bigquery`.`football`.`spi_matches_latest`
where league is null



      
    ) dbt_internal_test
[0m12:04:21.790411 [debug] [Thread-3  ]: On test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team2
from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
where team2 is null



      
    ) dbt_internal_test
[0m12:04:23.720008 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:8caaf365-8989-44cd-a9dc-ecfaa8bf1b59&page=queryresults
[0m12:04:23.722665 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:97142077-074d-40f8-9b18-8c5ae707549b&page=queryresults
[0m12:04:23.723992 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:9cbb080c-1546-481e-8e75-9f206a8f8786&page=queryresults
[0m12:04:23.725361 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:44d304dc-bc09-4669-b75c-465422f70790&page=queryresults
[0m12:04:24.635030 [debug] [Thread-4  ]: Timing info for test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6 (execute): 12:04:21.694839 => 12:04:24.634609
[0m12:04:24.636623 [debug] [Thread-1  ]: Timing info for test.estudos_dbt.assert_valid_season (execute): 12:04:21.661103 => 12:04:24.636193
[0m12:04:24.638630 [debug] [Thread-3  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae (execute): 12:04:21.698315 => 12:04:24.637910
[0m12:04:24.640119 [info ] [Thread-4  ]: 4 of 4 PASS source_not_null_spi_spi_matches_latest_league ...................... [[32mPASS[0m in 3.05s]
[0m12:04:24.642201 [info ] [Thread-1  ]: 1 of 4 PASS assert_valid_season ................................................ [[32mPASS[0m in 3.06s]
[0m12:04:24.644179 [info ] [Thread-3  ]: 3 of 4 PASS not_null_stg_football_matches_team2 ................................ [[32mPASS[0m in 3.06s]
[0m12:04:24.645526 [debug] [Thread-4  ]: Finished running node test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6
[0m12:04:24.647286 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53 (execute): 12:04:21.689252 => 12:04:24.646763
[0m12:04:24.648592 [debug] [Thread-1  ]: Finished running node test.estudos_dbt.assert_valid_season
[0m12:04:24.650464 [debug] [Thread-3  ]: Finished running node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m12:04:24.653134 [info ] [Thread-2  ]: 2 of 4 PASS not_null_stg_football_matches_team1 ................................ [[32mPASS[0m in 3.07s]
[0m12:04:24.655198 [debug] [Thread-2  ]: Finished running node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m12:04:24.658384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:24.659046 [debug] [MainThread]: Connection 'test.estudos_dbt.assert_valid_season' was properly closed.
[0m12:04:24.659948 [debug] [MainThread]: Connection 'test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae' was properly closed.
[0m12:04:24.660540 [debug] [MainThread]: Connection 'test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53' was properly closed.
[0m12:04:24.661374 [debug] [MainThread]: Connection 'test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6' was properly closed.
[0m12:04:24.662102 [info ] [MainThread]: 
[0m12:04:24.662825 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.93 seconds (3.93s).
[0m12:04:24.665540 [debug] [MainThread]: Command end result
[0m12:04:24.676560 [info ] [MainThread]: 
[0m12:04:24.677310 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:04:24.677978 [info ] [MainThread]: 
[0m12:04:24.679043 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:04:24.680157 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.363916, "process_user_time": 7.51122, "process_kernel_time": 0.909466, "process_mem_max_rss": "203808", "process_out_blocks": "2824", "process_in_blocks": "0"}
[0m12:04:24.681492 [debug] [MainThread]: Command `dbt test` succeeded at 12:04:24.681135 after 6.37 seconds
[0m12:04:24.682555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea22dc4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8f4705b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8f505f10>]}
[0m12:04:24.683441 [debug] [MainThread]: Flushing usage events
[0m12:06:45.133880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25537b9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2551a99670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2551a99e20>]}


============================== 12:06:45.136997 | 2a3ef1d4-7621-491b-bb46-4fa382895762 ==============================
[0m12:06:45.136997 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:06:45.137828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/pedromarques/Documentos/GitHub/estudos-dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/pedromarques/Documentos/GitHub/estudos-dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m12:06:46.304839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a3ef1d4-7621-491b-bb46-4fa382895762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2551ad4400>]}
[0m12:06:46.496599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a3ef1d4-7621-491b-bb46-4fa382895762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25408fbd90>]}
[0m12:06:46.497532 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m12:06:46.508620 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:06:46.562629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:06:46.563390 [debug] [MainThread]: Partial parsing: added file: estudos_dbt://tests/assert_source_diff_teams.sql
[0m12:06:46.749487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a3ef1d4-7621-491b-bb46-4fa382895762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25400b6b80>]}
[0m12:06:46.764178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a3ef1d4-7621-491b-bb46-4fa382895762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2540132fd0>]}
[0m12:06:46.764846 [info ] [MainThread]: Found 3 models, 5 tests, 2 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:06:46.765435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a3ef1d4-7621-491b-bb46-4fa382895762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25400d2310>]}
[0m12:06:46.767356 [info ] [MainThread]: 
[0m12:06:46.768399 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:06:46.769996 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_estudos-dbt-e-bigquery_dbt_football'
[0m12:06:46.771134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:47.590354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a3ef1d4-7621-491b-bb46-4fa382895762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2540121dc0>]}
[0m12:06:47.592497 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:06:47.593119 [info ] [MainThread]: 
[0m12:06:47.596011 [debug] [Thread-1  ]: Began running node test.estudos_dbt.assert_source_diff_teams
[0m12:06:47.596626 [info ] [Thread-1  ]: 1 of 5 START test assert_source_diff_teams ..................................... [RUN]
[0m12:06:47.597392 [debug] [Thread-2  ]: Began running node test.estudos_dbt.assert_valid_season
[0m12:06:47.598730 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_estudos-dbt-e-bigquery_dbt_football, now test.estudos_dbt.assert_source_diff_teams)
[0m12:06:47.599748 [debug] [Thread-3  ]: Began running node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m12:06:47.600507 [debug] [Thread-4  ]: Began running node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m12:06:47.601272 [info ] [Thread-2  ]: 2 of 5 START test assert_valid_season .......................................... [RUN]
[0m12:06:47.602477 [debug] [Thread-1  ]: Began compiling node test.estudos_dbt.assert_source_diff_teams
[0m12:06:47.603589 [info ] [Thread-3  ]: 3 of 5 START test not_null_stg_football_matches_team1 .......................... [RUN]
[0m12:06:47.604781 [info ] [Thread-4  ]: 4 of 5 START test not_null_stg_football_matches_team2 .......................... [RUN]
[0m12:06:47.607498 [debug] [Thread-2  ]: Acquiring new bigquery connection 'test.estudos_dbt.assert_valid_season'
[0m12:06:47.619796 [debug] [Thread-3  ]: Acquiring new bigquery connection 'test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53'
[0m12:06:47.621016 [debug] [Thread-1  ]: Writing injected SQL for node "test.estudos_dbt.assert_source_diff_teams"
[0m12:06:47.625025 [debug] [Thread-4  ]: Acquiring new bigquery connection 'test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae'
[0m12:06:47.626582 [debug] [Thread-2  ]: Began compiling node test.estudos_dbt.assert_valid_season
[0m12:06:47.628256 [debug] [Thread-3  ]: Began compiling node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m12:06:47.629919 [debug] [Thread-4  ]: Began compiling node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m12:06:47.634670 [debug] [Thread-2  ]: Writing injected SQL for node "test.estudos_dbt.assert_valid_season"
[0m12:06:47.635686 [debug] [Thread-1  ]: Timing info for test.estudos_dbt.assert_source_diff_teams (compile): 12:06:47.608880 => 12:06:47.635141
[0m12:06:47.666022 [debug] [Thread-1  ]: Began executing node test.estudos_dbt.assert_source_diff_teams
[0m12:06:47.683021 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.assert_valid_season (compile): 12:06:47.630600 => 12:06:47.682686
[0m12:06:47.683985 [debug] [Thread-4  ]: Writing injected SQL for node "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"
[0m12:06:47.682416 [debug] [Thread-3  ]: Writing injected SQL for node "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"
[0m12:06:47.690734 [debug] [Thread-2  ]: Began executing node test.estudos_dbt.assert_valid_season
[0m12:06:47.708713 [debug] [Thread-1  ]: Writing runtime sql for node "test.estudos_dbt.assert_source_diff_teams"
[0m12:06:47.712345 [debug] [Thread-2  ]: Writing runtime sql for node "test.estudos_dbt.assert_valid_season"
[0m12:06:47.713549 [debug] [Thread-4  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae (compile): 12:06:47.641467 => 12:06:47.712973
[0m12:06:47.714882 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:06:47.715833 [debug] [Thread-3  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53 (compile): 12:06:47.636265 => 12:06:47.715508
[0m12:06:47.716425 [debug] [Thread-4  ]: Began executing node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m12:06:47.717196 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:06:47.717860 [debug] [Thread-3  ]: Began executing node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m12:06:47.721518 [debug] [Thread-4  ]: Writing runtime sql for node "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"
[0m12:06:47.727616 [debug] [Thread-3  ]: Writing runtime sql for node "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"
[0m12:06:47.729170 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:06:47.730138 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:06:47.806110 [debug] [Thread-1  ]: On test.estudos_dbt.assert_source_diff_teams: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.assert_source_diff_teams"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with matches as (
    select * from `estudos-dbt-e-bigquery`.`football`.`spi_matches_latest`
)

select *
from matches
where team1 = team2
      
    ) dbt_internal_test
[0m12:06:47.809376 [debug] [Thread-3  ]: On test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team1
from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
where team1 is null



      
    ) dbt_internal_test
[0m12:06:47.810331 [debug] [Thread-4  ]: On test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team2
from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
where team2 is null



      
    ) dbt_internal_test
[0m12:06:47.811824 [debug] [Thread-2  ]: On test.estudos_dbt.assert_valid_season: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.assert_valid_season"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with matches as (
    select * from `estudos-dbt-e-bigquery`.`dbt_football`.`stg_football_matches`
)

select *
from matches
where season not in (
    2019,
    2021,
    2022
)
      
    ) dbt_internal_test
[0m12:06:49.003544 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:a6fca197-802d-4063-9cd7-dadad80b703a&page=queryresults
[0m12:06:49.062731 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:d5bac9ff-9314-4e8a-8a39-ed147a285cce&page=queryresults
[0m12:06:49.086908 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:daabe42a-cfe1-4929-82e0-21c933207d5a&page=queryresults
[0m12:06:49.950881 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.assert_valid_season (execute): 12:06:47.709375 => 12:06:49.949743
[0m12:06:49.953941 [info ] [Thread-2  ]: 2 of 5 PASS assert_valid_season ................................................ [[32mPASS[0m in 2.35s]
[0m12:06:49.955250 [debug] [Thread-2  ]: Finished running node test.estudos_dbt.assert_valid_season
[0m12:06:49.955951 [debug] [Thread-2  ]: Began running node test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6
[0m12:06:49.956538 [info ] [Thread-2  ]: 5 of 5 START test source_not_null_spi_spi_matches_latest_league ................ [RUN]
[0m12:06:49.958093 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.estudos_dbt.assert_valid_season, now test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6)
[0m12:06:49.960095 [debug] [Thread-4  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae (execute): 12:06:47.718526 => 12:06:49.959449
[0m12:06:49.961263 [debug] [Thread-2  ]: Began compiling node test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6
[0m12:06:49.962718 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:e59f2720-d699-49f2-b775-366b520200cf&page=queryresults
[0m12:06:49.964850 [debug] [Thread-3  ]: Timing info for test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53 (execute): 12:06:47.722170 => 12:06:49.964251
[0m12:06:49.966770 [info ] [Thread-4  ]: 4 of 5 PASS not_null_stg_football_matches_team2 ................................ [[32mPASS[0m in 2.34s]
[0m12:06:49.980211 [debug] [Thread-2  ]: Writing injected SQL for node "test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6"
[0m12:06:49.981627 [info ] [Thread-3  ]: 3 of 5 PASS not_null_stg_football_matches_team1 ................................ [[32mPASS[0m in 2.36s]
[0m12:06:49.983597 [debug] [Thread-4  ]: Finished running node test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae
[0m12:06:49.987292 [debug] [Thread-3  ]: Finished running node test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53
[0m12:06:49.990247 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6 (compile): 12:06:49.967478 => 12:06:49.988429
[0m12:06:49.992098 [debug] [Thread-2  ]: Began executing node test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6
[0m12:06:50.088095 [debug] [Thread-2  ]: Writing runtime sql for node "test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6"
[0m12:06:50.089197 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:06:50.134024 [debug] [Thread-2  ]: On test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "football", "target_name": "dev", "node_id": "test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select league
from `estudos-dbt-e-bigquery`.`football`.`spi_matches_latest`
where league is null



      
    ) dbt_internal_test
[0m12:06:50.804138 [debug] [Thread-1  ]: Timing info for test.estudos_dbt.assert_source_diff_teams (execute): 12:06:47.672433 => 12:06:50.802928
[0m12:06:50.807866 [info ] [Thread-1  ]: 1 of 5 PASS assert_source_diff_teams ........................................... [[32mPASS[0m in 3.21s]
[0m12:06:50.810910 [debug] [Thread-1  ]: Finished running node test.estudos_dbt.assert_source_diff_teams
[0m12:06:51.170479 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=estudos-dbt-e-bigquery&j=bq:US:fda2a493-7e33-46ff-8575-2b168619df0d&page=queryresults
[0m12:06:52.298441 [debug] [Thread-2  ]: Timing info for test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6 (execute): 12:06:49.993219 => 12:06:52.297042
[0m12:06:52.300232 [info ] [Thread-2  ]: 5 of 5 PASS source_not_null_spi_spi_matches_latest_league ...................... [[32mPASS[0m in 2.34s]
[0m12:06:52.301232 [debug] [Thread-2  ]: Finished running node test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6
[0m12:06:52.303215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:06:52.303759 [debug] [MainThread]: Connection 'test.estudos_dbt.assert_source_diff_teams' was properly closed.
[0m12:06:52.304215 [debug] [MainThread]: Connection 'test.estudos_dbt.source_not_null_spi_spi_matches_latest_league.15e25022b6' was properly closed.
[0m12:06:52.304762 [debug] [MainThread]: Connection 'test.estudos_dbt.not_null_stg_football_matches_team1.ce4b914a53' was properly closed.
[0m12:06:52.305324 [debug] [MainThread]: Connection 'test.estudos_dbt.not_null_stg_football_matches_team2.06d446a3ae' was properly closed.
[0m12:06:52.305934 [info ] [MainThread]: 
[0m12:06:52.306915 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 5.54 seconds (5.54s).
[0m12:06:52.309723 [debug] [MainThread]: Command end result
[0m12:06:52.327143 [info ] [MainThread]: 
[0m12:06:52.327929 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:06:52.328659 [info ] [MainThread]: 
[0m12:06:52.329635 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:06:52.331147 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.28176, "process_user_time": 6.65543, "process_kernel_time": 0.579261, "process_mem_max_rss": "194012", "process_out_blocks": "2896", "process_in_blocks": "0"}
[0m12:06:52.332124 [debug] [MainThread]: Command `dbt test` succeeded at 12:06:52.331856 after 7.28 seconds
[0m12:06:52.332982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25537b9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2540ca2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25408fbd90>]}
[0m12:06:52.334396 [debug] [MainThread]: Flushing usage events
